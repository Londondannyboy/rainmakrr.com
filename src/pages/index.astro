---
import { sql } from '../lib/db';
import { marked } from 'marked';
import SEO from '../components/SEO.astro';
import Schema from '../components/Schema.astro';
import PlacementAgentsComparisonTable from '../components/PlacementAgentsComparisonTable.astro';
import { getVisitorCountry, sortAgentsByGeo, getCountryName, getRegionForCountry } from '../lib/geo';
// Using system fonts - no Google Fonts needed

// Detect visitor's country for geo-targeting
const visitorCountry = getVisitorCountry(Astro.request);
const visitorCountryName = getCountryName(visitorCountry);
const visitorRegion = getRegionForCountry(visitorCountry);

// Fetch homepage content
const homepageContent = await sql`
  SELECT section_type, title, subtitle, content, hero_background_type, hero_background_url
  FROM homepage_content
  WHERE site = 'placement' AND is_active = true
  ORDER BY section_order ASC
`;

// Fetch companies - filter for placement agents (fetch all for progressive loading)
const companies = await sql`
  SELECT
    name,
    COALESCE(display_name, name) as display_name,
    slug,
    description,
    headquarters,
    logo_url,
    featured_asset_url,
    specializations,
    global_rank,
    tags,
    primary_country,
    primary_region
  FROM companies
  WHERE status = 'published'
    AND company_type = 'placement_agent'
  ORDER BY
    CASE WHEN global_rank IS NOT NULL THEN 0 ELSE 1 END,
    global_rank ASC NULLS LAST,
    name ASC
`;

// Split companies into top tier and others based on tags
const topCompanies = companies.filter((c: any) => c.tags && c.tags.includes('top'));
const otherCompanies = companies.filter((c: any) => !c.tags || !c.tags.includes('top'));

// Apply geo-targeting: sort each group by visitor's country/region
const topCompaniesSorted = sortAgentsByGeo(topCompanies, visitorCountry);
const otherCompaniesSorted = sortAgentsByGeo(otherCompanies, visitorCountry);

// Combined list: top agents first (geo-sorted), then others (geo-sorted)
const allAgents = [...topCompaniesSorted, ...otherCompaniesSorted];

// Fetch articles with video/image support and content for full sections
const articlesRaw = await sql`
  SELECT
    title,
    excerpt,
    content,
    slug,
    published_at,
    hero_asset_url,
    featured_asset_url,
    video_url,
    video_playback_id
  FROM articles
  WHERE app = 'placement'
    AND status = 'published'
  ORDER BY published_at DESC NULLS LAST
  LIMIT 8
`;

// Process articles with video-first priority
const articles = articlesRaw.map((article: any) => {
  const playbackId = article.video_playback_id;
  // Mux thumbnails with responsive sizes and quality compression
  const thumbnailUrl = playbackId
    ? `https://image.mux.com/${playbackId}/thumbnail.webp?time=1&width=300&fit_mode=preserve&quality=60`
    : (article.featured_asset_url || article.hero_asset_url);
  // Srcset for responsive loading with compression
  const thumbnailSrcset = playbackId
    ? `https://image.mux.com/${playbackId}/thumbnail.webp?time=1&width=200&fit_mode=preserve&quality=60 200w, https://image.mux.com/${playbackId}/thumbnail.webp?time=1&width=300&fit_mode=preserve&quality=60 300w, https://image.mux.com/${playbackId}/thumbnail.webp?time=1&width=400&fit_mode=preserve&quality=60 400w`
    : '';
  return {
    ...article,
    mux_playback_id: playbackId,
    thumbnail_url: thumbnailUrl,
    thumbnail_srcset: thumbnailSrcset
  };
});

const sections = {
  hero: homepageContent.find((s: any) => s.section_type === 'hero'),
  intro: homepageContent.find((s: any) => s.section_type === 'intro'),
  role: homepageContent.find((s: any) => s.section_type === 'role'),
  top_agents: homepageContent.find((s: any) => s.section_type === 'top_agents'),
  how_it_works: homepageContent.find((s: any) => s.section_type === 'how_it_works'),
  fee_structures: homepageContent.find((s: any) => s.section_type === 'fee_structures'),
  selection: homepageContent.find((s: any) => s.section_type === 'selection'),
  trends: homepageContent.find((s: any) => s.section_type === 'trends'),
  why_use: homepageContent.find((s: any) => s.section_type === 'why_use'),
  faq: homepageContent.find((s: any) => s.section_type === 'faq'),
  references: homepageContent.find((s: any) => s.section_type === 'references'),
};

// Debug: Log which sections are loaded
console.log('Homepage sections loaded:', Object.entries(sections).map(([key, val]) => ({
  key,
  hasData: !!val,
  hasContent: !!(val && (val as any).content),
  contentKeys: val ? Object.keys((val as any).content || {}) : []
})));

// Debug specific sections
if (sections.intro) {
  console.log('Intro section:', {
    title: sections.intro.title,
    hasContent: !!sections.intro.content,
    contentType: typeof sections.intro.content,
    content: sections.intro.content
  });
}

if (sections.role) {
  console.log('Role section:', {
    title: sections.role.title,
    hasContent: !!sections.role.content,
    hasItems: !!(sections.role.content as any)?.items,
    itemsLength: (sections.role.content as any)?.items?.length
  });
}

// Hero video from database (CMS-managed)
const heroSection = sections.hero as any;
const heroBackgroundType = heroSection?.hero_background_type || 'video';
const heroBackgroundUrl = heroSection?.hero_background_url || '';
// Extract Mux playback ID from URL (format: https://stream.mux.com/{playbackId}.m3u8)
const heroPlaybackId = heroBackgroundUrl.match(/stream\.mux\.com\/([^./]+)/)?.[1] || 'qIS6PGKxIZyzjrDBzxQuqPRBOhHofDnXq1chdsqAY9Y';

const heroCarouselItems = [
  {
    type: heroBackgroundType,
    src: heroPlaybackId,
  }
];

// Keep original for backward compatibility
const muxPlaybackId = heroCarouselItems[0].src;

// Image optimization helpers for mobile performance
function optimizeCloudinaryImage(url: string, width: number = 800) {
  if (!url || !url.includes('cloudinary.com')) return url;
  // q_50 = 50% quality, w_X = max width, c_limit = don't upscale
  const transformations = `q_50,w_${width},c_limit`;
  // Add transformations and change extension to .webp for explicit WebP delivery
  return url.replace('/upload/', `/upload/${transformations}/`).replace(/\.(jpg|jpeg|png)$/i, '.webp');
}

function generateSrcSet(url: string) {
  if (!url || !url.includes('cloudinary.com')) return '';
  const widths = [400, 600, 800];
  return widths.map(w => `${optimizeCloudinaryImage(url, w)} ${w}w`).join(', ');
}

// Clean duplicate consecutive headings and fix accessibility from HTML content (SEO fix)
function cleanDuplicateHeadings(html: string): string {
  if (!html) return '';
  // Remove duplicate consecutive H2/H3 headings with same text
  let cleaned = html.replace(/(<h[23][^>]*>([^<]+)<\/h[23]>)\s*\1/gi, '$1');
  // Fix accessibility: Replace text-blue-600 with text-blue-300 for dark backgrounds (WCAG AAA)
  cleaned = cleaned.replace(/text-blue-600/g, 'text-blue-300');
  cleaned = cleaned.replace(/hover:text-blue-800/g, 'hover:text-blue-200');
  return cleaned;
}

// Generate varied descriptions to avoid duplicate content
function generateVariedDescription(company: any, context: 'primary' | 'secondary' = 'primary'): string {
  if (context === 'primary') {
    // Use original description for primary display
    return company.description || '';
  }

  // Generate unique secondary descriptions focusing on different aspects
  const specs = company.specializations || [];
  const region = company.primary_region || company.primary_country || '';
  const name = company.display_name || company.name;

  // Create highly varied taglines - 16 templates for better distribution
  const templates = [
    `Specialized ${specs[0] || 'private markets'} advisory with ${region ? region + ' ' : ''}capital formation expertise`,
    `Independent firm serving ${specs.slice(0, 2).join(' and ') || 'private markets'} fund managers globally`,
    `Leading placement services for ${specs[0] || 'alternative asset'} managers seeking institutional capital`,
    `Global network connecting ${specs[0] || 'private equity'} funds with institutional investors`,
    `Expert fundraising solutions for ${specs.join(', ') || 'alternative investment'} strategies`,
    `Trusted ${region ? region + ' ' : ''}partner for ${specs[0] || 'PE'} fund managers`,
    `Specialized advisor bridging ${specs[0] || 'private equity'} managers with pension funds`,
    `${region ? region + '-based ' : ''}placement firm with ${specs.slice(0, 2).join(' and ') || 'alternative assets'} focus`,
    `Strategic counsel for ${specs[0] || 'alternative'} managers targeting sophisticated LPs`,
    `Boutique advisory delivering ${specs[0] || 'private markets'} capital raising across ${region || 'global'} markets`,
    `Experienced ${specs[0] || 'PE'} fundraising team with institutional investor access`,
    `${name} offers ${specs.join(', ') || 'private equity'} distribution capabilities`,
    `${region || 'Global'} placement specialist for ${specs[0] || 'PE'} and credit strategies`,
    `Dedicated ${specs[0] || 'alternative'} fundraising advisory with endowment relationships`,
    `Premier ${specs.slice(0, 2).join('/') || 'private markets'} placement partner for fund managers`,
    `${name} provides targeted ${specs[0] || 'PE'} investor introductions across key markets`,
  ];

  // Use name length + char sum for better distribution across 16 templates
  const hash = name.length + name.split('').reduce((acc: number, char: string) => acc + char.charCodeAt(0), 0);
  return templates[hash % templates.length];
}
---

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <SEO />
  <Schema type="homepage" />

  <!-- Preconnect to critical origins -->
  <link rel="preconnect" href="https://image.mux.com" crossorigin>
  <link rel="preconnect" href="https://stream.mux.com" crossorigin>

  <!-- Preload first article thumbnail for faster LCP -->
  {articles[0]?.thumbnail_url && (
    <link rel="preload" as="image" href={articles[0].thumbnail_url} />
  )}

  <!-- Critical CSS inline - renders logo/nav immediately without waiting for external CSS -->
  <style>
    .logo{font-size:20px;font-weight:700;color:#fff;text-decoration:none}
    nav{position:fixed;top:0;left:0;right:0;z-index:1000;padding:24px 60px;display:flex;justify-content:space-between;align-items:center;background:rgba(0,0,0,.5);backdrop-filter:blur(20px);border-bottom:1px solid rgba(255,255,255,.1)}
    body{font-family:Inter,-apple-system,BlinkMacSystemFont,sans-serif;background:#000;color:#fff;margin:0}
  </style>

  <!-- Structured Data: Key Criteria List -->
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "ItemList",
      "name": "Top Private Equity Placement Agent Selection Criteria",
      "description": "Key criteria that define the world's leading private equity placement agents",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "Proven Track Record",
          "description": "Top-ranked firms like Campbell Lutyens (#1 in Preqin 2025) and PJT Park Hill have closed billions in capital across multiple fund cycles"
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "LP Network Depth",
          "description": "Access to 500-1,000+ institutional investors including pension funds, sovereign wealth funds, insurance companies, and family offices globally"
        },
        {
          "@type": "ListItem",
          "position": 3,
          "name": "Strategy Expertise",
          "description": "Specialized knowledge across buyout, venture capital, private credit, infrastructure, and real estate"
        },
        {
          "@type": "ListItem",
          "position": 4,
          "name": "Geographic Reach",
          "description": "Leading firms maintain offices across North America, Europe, and Asia Pacific to access global LP pools"
        },
        {
          "@type": "ListItem",
          "position": 5,
          "name": "Regulatory Compliance",
          "description": "Full regulatory registration (SEC, FCA, etc.) and adherence to industry best practices including ILPA guidelines"
        }
      ]
    }
  </script>

  <!-- Structured Data: VideoObject for SEO -->
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "VideoObject",
      "name": "Top Private Equity Placement Agents - Industry Overview",
      "description": "Explore the world's leading private equity placement agents. Comprehensive guide to PE fundraising advisors, LP networks, and capital raising strategies for fund managers.",
      "thumbnailUrl": "https://image.mux.com/qIS6PGKxIZyzjrDBzxQuqPRBOhHofDnXq1chdsqAY9Y/thumbnail.jpg?width=1920&height=1080&time=0",
      "contentUrl": "https://stream.mux.com/qIS6PGKxIZyzjrDBzxQuqPRBOhHofDnXq1chdsqAY9Y/high.mp4",
      "embedUrl": "https://placement.quest/",
      "uploadDate": "2025-01-01T00:00:00Z",
      "duration": "PT30S",
      "publisher": {
        "@type": "Organization",
        "name": "Placement Quest | Private Equity Placement Agents",
        "logo": {
          "@type": "ImageObject",
          "url": "https://placement.quest/logo.png"
        }
      }
    }
  </script>

  <!-- Performance: Critical resource hints -->
  <link rel="preconnect" href="https://res.cloudinary.com" crossorigin>
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    html { scroll-behavior: smooth; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: #000;
      color: #fff;
      line-height: 1.6;
      overflow-x: hidden;
    }

    /* Fix deprecated H1UserAgentFontSizeInSection - prevent browser from auto-adjusting h1 size in sections */
    section h1,
    article h1,
    aside h1,
    nav h1 {
      font-size: inherit;
    }

    /* Navigation */
    nav {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 1000;
      padding: 24px 60px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .logo {
      font-size: 20px;
      font-weight: 700;
      color: #fff;
    }

    .nav-links {
      display: flex;
      gap: 40px;
      list-style: none;
    }

    .nav-links a {
      color: #fff;
      text-decoration: none;
      font-weight: 600;
      font-size: 14px;
      transition: opacity 0.3s;
    }

    .nav-links a:hover { opacity: 0.6; }

    /* Dropdown navigation */
    .nav-item {
      position: relative;
    }

    .dropdown {
      position: absolute;
      top: 100%;
      left: 0;
      background: rgba(0, 0, 0, 0.95);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      padding: 12px 0;
      min-width: 250px;
      opacity: 0;
      visibility: hidden;
      transform: translateY(-10px);
      transition: opacity 0.3s cubic-bezier(0.23, 1, 0.32, 1), transform 0.3s cubic-bezier(0.23, 1, 0.32, 1), visibility 0.3s;
      z-index: 1000;
      margin-top: 12px;
    }

    .nav-item:hover .dropdown {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }

    .dropdown a {
      display: block;
      padding: 10px 20px;
      color: rgba(255, 255, 255, 0.8);
      transition: background-color 0.2s, color 0.2s;
    }

    .dropdown a:hover {
      background: rgba(255, 255, 255, 0.05);
      color: #fff;
      opacity: 1;
    }

    .dropdown-divider {
      height: 1px;
      background: rgba(255, 255, 255, 0.1);
      margin: 8px 0;
    }

    /* Hamburger Menu */
    .hamburger {
      display: none;
      flex-direction: column;
      background: none;
      border: none;
      cursor: pointer;
      padding: 0;
      gap: 6px;
    }

    .hamburger span {
      width: 24px;
      height: 2.5px;
      background: #fff;
      border-radius: 2px;
      transition: transform 0.3s ease, opacity 0.3s ease;
    }

    .hamburger.active span:nth-child(1) {
      transform: rotate(45deg) translate(10px, 10px);
    }

    .hamburger.active span:nth-child(2) {
      opacity: 0;
    }

    .hamburger.active span:nth-child(3) {
      transform: rotate(-45deg) translate(7px, -7px);
    }

    /* Hero with Mux Video */
    .hero {
      height: 100vh;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    .hero-carousel {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 0;
    }

    .hero-carousel-item {
      position: absolute;
      top: 50%;
      left: 50%;
      min-width: 100%;
      min-height: 100%;
      width: auto;
      height: auto;
      transform: translate(-50%, -50%);
      opacity: 0;
      transition: opacity 1.2s ease-in-out;
      z-index: 0;
    }

    .hero-carousel-item.active {
      opacity: 0.7;
      z-index: 1;
    }

    .hero-video {
      object-fit: cover;
    }

    .hero-image {
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
    }

    .hero-overlay {
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.3), rgba(0, 0, 0, 0.6));
      z-index: 1;
    }

    .hero-content {
      position: relative;
      z-index: 10;
      text-align: center;
      padding: 0 40px;
      max-width: 1400px;
    }

    .hero-badge {
      display: inline-flex;
      align-items: center;
      background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(20px);
      padding: 12px 28px;
      border-radius: 100px;
      border: 1px solid rgba(255, 255, 255, 0.3);
      margin-bottom: 40px;
      font-size: 14px;
      font-weight: 600;
      letter-spacing: 1.5px;
      text-transform: uppercase;
      opacity: 1;
    }

    .hero-badge::before {
      content: '';
      width: 10px;
      height: 10px;
      background: #10b981;
      border-radius: 50%;
      margin-right: 12px;
      animation: pulse 2s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.5; transform: scale(1.3); }
    }

    @keyframes welcomeFade {
      0% { opacity: 0; transform: translateY(30px); }
      100% { opacity: 1; transform: translateY(0); }
    }

    .welcome-text {
      animation: welcomeFade 1.5s ease-out;
    }

    .hero h1 {
      font-size: clamp(48px, 8vw, 140px);
      font-weight: 900;
      line-height: 1;
      letter-spacing: -0.03em;
      margin-bottom: 40px;
      text-transform: uppercase;
      text-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
      opacity: 1;
    }

    .hero-subtitle {
      font-size: clamp(18px, 2.5vw, 28px);
      font-weight: 300;
      line-height: 1.7;
      max-width: 900px;
      margin: 0 auto 60px;
      opacity: 1;
    }

    .hero-cta {
      display: flex;
      gap: 20px;
      justify-content: center;
      flex-wrap: wrap;
      opacity: 1;
    }

    .btn {
      padding: 20px 48px;
      border-radius: 100px;
      font-weight: 700;
      font-size: 16px;
      letter-spacing: 0.5px;
      text-decoration: none;
      cursor: pointer;
      transition: transform 0.3s cubic-bezier(0.23, 1, 0.32, 1), background-color 0.3s, box-shadow 0.3s;
      display: inline-block;
      will-change: transform;
    }

    .btn-primary {
      background: #3730a3;
      color: #fff;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
    }

    .btn-primary:hover {
      background: #2a2380;
      transform: scale(1.05) translateY(-3px);
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
    }

    .btn-secondary {
      background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(20px);
      color: #fff;
      border: 2px solid rgba(255, 255, 255, 0.4);
    }

    .btn-secondary:hover {
      background: rgba(255, 255, 255, 0.25);
    }

    /* Stats Section - Qualitative instead of numbers */
    .stats-section {
      padding: 200px 60px;
      position: relative;
      overflow: hidden;
    }

    .stats-bg {
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.3) 0%, rgba(118, 75, 162, 0.2) 50%, rgba(0, 0, 0, 0.8) 100%);
      opacity: 0.6;
    }

    .stats-bg::after {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.5), rgba(0, 0, 0, 0.7));
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 80px;
      max-width: 1400px;
      margin: 0 auto;
      position: relative;
      z-index: 1;
    }

    .stat-item {
      text-align: center;
      opacity: 1;
    }

    .stat-title {
      font-size: clamp(32px, 5vw, 48px);
      font-weight: 900;
      background: linear-gradient(135deg, #fff, #f093fb);
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      line-height: 1.2;
      margin-bottom: 20px;
    }

    .stat-label {
      font-size: 16px;
      font-weight: 500;
      color: rgba(255, 255, 255, 0.7);
      line-height: 1.6;
    }

    /* Portfolio-style Image Grid */
    .portfolio-section {
      padding: 0;
      background: #000;
    }

    .portfolio-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 0;
    }

    .portfolio-item {
      position: relative;
      height: 90vh;
      overflow: hidden;
      cursor: pointer;
    }

    .portfolio-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.6s cubic-bezier(0.23, 1, 0.32, 1);
    }

    .portfolio-item:hover img {
      transform: scale(1.05);
    }

    .portfolio-overlay {
      position: absolute;
      inset: 0;
      background: linear-gradient(to top, rgba(0, 0, 0, 0.9), transparent);
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      padding: 60px;
      opacity: 0;
      transition: opacity 0.4s;
    }

    .portfolio-item:hover .portfolio-overlay {
      opacity: 1;
    }

    .portfolio-title {
      font-size: 36px;
      font-weight: 900;
      margin-bottom: 12px;
    }

    .portfolio-desc {
      font-size: 16px;
      color: rgba(255, 255, 255, 0.8);
    }

    /* Companies Section */
    .companies-section {
      padding: 200px 60px;
      position: relative;
      overflow: hidden;
      background: #000;
    }

    .companies-video-bg {
      position: absolute;
      inset: 0;
      z-index: 0;
    }

    .companies-video-bg video {
      width: 100%;
      height: 100%;
      object-fit: cover;
      opacity: 0.25;
    }

    .companies-overlay {
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, rgba(118, 75, 162, 0.75), rgba(102, 126, 234, 0.4), rgba(0, 0, 0, 0.85));
      z-index: 1;
    }

    .companies-content {
      position: relative;
      z-index: 2;
      max-width: 1400px;
      margin: 0 auto;
    }

    .section-header {
      text-align: center;
      margin-bottom: 100px;
    }

    .section-header h2 {
      font-size: clamp(40px, 6vw, 80px);
      font-weight: 900;
      margin-bottom: 24px;
      line-height: 1.1;
      letter-spacing: -0.02em;
    }

    .section-header p {
      font-size: 20px;
      color: rgba(255, 255, 255, 0.7);
      max-width: 700px;
      margin: 0 auto 16px auto;
      line-height: 1.8;
    }

    .section-header p:last-child {
      margin-bottom: 0;
    }

    .companies-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 40px;
    }

    .company-card {
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 24px;
      padding: 40px;
      transition: transform 0.4s cubic-bezier(0.23, 1, 0.32, 1), background-color 0.4s, border-color 0.4s;
      opacity: 1;
      will-change: transform;
    }

    .company-card:hover {
      background: rgba(255, 255, 255, 0.08);
      border-color: rgba(255, 255, 255, 0.2);
      transform: translateY(-8px);
    }

    .company-card.hidden-card {
      display: none;
    }

    .company-header {
      display: flex;
      justify-content: space-between;
      align-items: start;
      margin-bottom: 24px;
    }

    .company-name {
      font-size: 28px;
      font-weight: 900;
      margin-bottom: 8px;
      background: linear-gradient(135deg, #fff, #f093fb);
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .company-location {
      font-size: 14px;
      color: rgba(255, 255, 255, 0.6);
      font-weight: 500;
    }

    .company-description {
      color: rgba(255, 255, 255, 0.8);
      line-height: 1.8;
      margin-bottom: 24px;
      font-size: 15px;
    }

    .company-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .tag {
      padding: 8px 16px;
      background: rgba(102, 126, 234, 0.2);
      border: 1px solid rgba(102, 126, 234, 0.3);
      border-radius: 100px;
      font-size: 12px;
      font-weight: 600;
      color: #667eea;
    }

    .empty-state {
      text-align: center;
      padding: 100px 20px;
    }

    .empty-state h3 {
      font-size: 32px;
      font-weight: 700;
      margin-bottom: 16px;
      color: rgba(255, 255, 255, 0.9);
    }

    .empty-state p {
      font-size: 18px;
      color: rgba(255, 255, 255, 0.6);
    }

    /* Full-width Image Section */
    .fullwidth-image-section {
      height: 80vh;
      position: relative;
      overflow: hidden;
    }

    .fullwidth-image-section img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .fullwidth-image-overlay {
      position: absolute;
      inset: 0;
      background: linear-gradient(to right, rgba(102, 126, 234, 0.7), rgba(118, 75, 162, 0.7));
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 60px;
    }

    .fullwidth-image-content h2 {
      font-size: clamp(48px, 8vw, 100px);
      font-weight: 900;
      margin-bottom: 32px;
      line-height: 1.1;
      text-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
    }

    .fullwidth-image-content p {
      font-size: 24px;
      max-width: 800px;
      margin: 0 auto;
      line-height: 1.6;
    }

    /* Services Grid */
    .services-section {
      padding: 200px 60px;
      background: linear-gradient(180deg, rgba(0, 0, 0, 0.95) 0%, rgba(15, 10, 20, 1) 100%);
      position: relative;
      overflow: hidden;
    }

    .services-section::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: radial-gradient(circle at 30% 50%, rgba(102, 126, 234, 0.08), transparent 50%),
                  radial-gradient(circle at 70% 50%, rgba(118, 75, 162, 0.08), transparent 50%);
      z-index: 0;
    }

    .services-section > * {
      position: relative;
      z-index: 1;
    }

    .services-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(360px, 1fr));
      gap: 30px;
      max-width: 1600px;
      margin: 80px auto 0;
    }

    .service-card {
      position: relative;
      height: 500px;
      border-radius: 20px;
      overflow: hidden;
      cursor: pointer;
    }

    .service-card img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.6s;
    }

    .service-card:hover img {
      transform: scale(1.1);
    }

    .service-overlay {
      position: absolute;
      inset: 0;
      background: linear-gradient(to top, rgba(0, 0, 0, 0.95), transparent);
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      padding: 40px;
    }

    .service-title {
      font-size: 28px;
      font-weight: 900;
      margin-bottom: 12px;
    }

    .service-desc {
      font-size: 15px;
      color: rgba(255, 255, 255, 0.8);
      line-height: 1.6;
    }

    /* CTA Section */
    .cta-section {
      padding: 200px 60px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .cta-section::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
      animation: pulse-slow 8s ease-in-out infinite;
    }

    @keyframes pulse-slow {
      0%, 100% { transform: scale(1); opacity: 0.5; }
      50% { transform: scale(1.1); opacity: 0.3; }
    }

    .cta-section > * {
      position: relative;
      z-index: 1;
    }

    .cta-section h2 {
      font-size: clamp(48px, 7vw, 90px);
      font-weight: 900;
      margin-bottom: 32px;
      line-height: 1.1;
    }

    .cta-section p {
      font-size: 22px;
      margin-bottom: 60px;
      max-width: 700px;
      margin-left: auto;
      margin-right: auto;
      line-height: 1.7;
    }

    /* PDF Guide CTA Section */
    .pdf-guide-cta {
      padding: 120px 60px;
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.15), rgba(118, 75, 162, 0.15));
      position: relative;
      overflow: hidden;
    }

    .pdf-guide-cta::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.15) 0%, rgba(240, 147, 251, 0.1) 100%);
      opacity: 0.5;
      z-index: 0;
    }

    .pdf-guide-content {
      position: relative;
      z-index: 1;
      max-width: 900px;
      margin: 0 auto;
      text-align: center;
    }

    .pdf-guide-badge {
      display: inline-block;
      background: rgba(102, 126, 234, 0.2);
      color: #667eea;
      padding: 8px 20px;
      border-radius: 100px;
      font-size: 12px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 1.5px;
      margin-bottom: 24px;
      border: 1px solid rgba(102, 126, 234, 0.3);
    }

    .pdf-guide-cta h2 {
      font-size: clamp(32px, 5vw, 48px);
      font-weight: 900;
      margin-bottom: 12px;
      line-height: 1.2;
    }

    .pdf-guide-cta h3 {
      font-size: clamp(24px, 4vw, 36px);
      font-weight: 700;
      color: #667eea;
      margin-bottom: 24px;
      line-height: 1.3;
    }

    .pdf-guide-cta p {
      font-size: 18px;
      line-height: 1.7;
      color: rgba(255, 255, 255, 0.9);
      margin-bottom: 40px;
      max-width: 700px;
      margin-left: auto;
      margin-right: auto;
    }

    .pdf-features {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 24px;
      margin-bottom: 48px;
    }

    .pdf-feature {
      display: flex;
      align-items: center;
      gap: 8px;
      background: rgba(255, 255, 255, 0.05);
      padding: 12px 20px;
      border-radius: 100px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      font-size: 14px;
      font-weight: 600;
    }

    .pdf-icon {
      font-size: 20px;
    }

    /* Footer */
    footer {
      padding: 80px 60px 40px;
      background: linear-gradient(180deg, rgba(0, 0, 0, 0.95) 0%, #000 100%);
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      position: relative;
    }

    footer::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 200px;
      background: linear-gradient(180deg, rgba(102, 126, 234, 0.05), transparent);
      pointer-events: none;
    }

    .footer-content {
      max-width: 1400px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 60px;
      margin-bottom: 60px;
    }

    .footer-section .footer-title {
      font-size: 18px;
      font-weight: 700;
      margin-bottom: 20px;
    }

    .footer-links {
      list-style: none;
    }

    .footer-links a {
      color: rgba(255, 255, 255, 0.6);
      text-decoration: none;
      display: block;
      margin-bottom: 12px;
      transition: color 0.3s;
    }

    .footer-links a:hover {
      color: #fff;
    }

    .footer-bottom {
      text-align: center;
      padding-top: 40px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      color: rgba(255, 255, 255, 0.5);
      font-size: 14px;
    }

    /* Content Sections from Database */
    .content-section {
      padding: 120px 60px;
      max-width: 1200px;
      margin: 0 auto;
      position: relative;
    }

    .content-section.dark {
      background: linear-gradient(180deg, #000 0%, #0a0a0a 100%);
    }

    .content-section.gradient {
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.15), rgba(118, 75, 162, 0.15), rgba(0, 0, 0, 0.95));
    }

    .content-section.gradient-alt {
      background: linear-gradient(225deg, rgba(118, 75, 162, 0.15), rgba(240, 147, 251, 0.1), rgba(0, 0, 0, 0.95));
    }

    .content-section.has-background {
      position: relative;
      overflow: hidden;
    }

    .content-section.has-background::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-size: cover;
      background-position: center;
      opacity: 0.15;
      z-index: 0;
    }

    .content-section.has-background > * {
      position: relative;
      z-index: 1;
    }

    .content-section.intro::before {
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.15) 0%, rgba(118, 75, 162, 0.1) 100%);
    }

    .content-section.top-agents::before {
      background: linear-gradient(135deg, rgba(240, 147, 251, 0.1) 0%, rgba(102, 126, 234, 0.15) 100%);
    }

    .content-section.fee-structures::before {
      background: linear-gradient(135deg, rgba(118, 75, 162, 0.15) 0%, rgba(240, 147, 251, 0.1) 100%);
    }

    .content-section.trends::before {
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.15) 100%);
    }

    .content-section.why-use::before {
      background: linear-gradient(135deg, rgba(240, 147, 251, 0.15) 0%, rgba(102, 126, 234, 0.1) 100%);
      opacity: 0.5;
    }

    .content-section.faq::before {
      background: linear-gradient(135deg, rgba(118, 75, 162, 0.1) 0%, rgba(240, 147, 251, 0.15) 100%);
      opacity: 0.5;
    }

    .content-section.animated {
      opacity: 1;
      transform: translateY(0);
    }

    /* Accessibility: High contrast links on dark backgrounds (WCAG AAA) */
    .content-section a.text-blue-600,
    .content-section .text-blue-600,
    section[style*="background: rgba(0"] a.text-blue-600,
    section[style*="background: rgba(0"] .text-blue-600 {
      color: #93c5fd !important; /* blue-300 - 7:1 contrast on dark */
    }
    .content-section a.text-blue-600:hover,
    .content-section a.hover\:text-blue-800:hover,
    section[style*="background: rgba(0"] a:hover {
      color: #bfdbfe !important; /* blue-200 - even higher contrast */
    }
    /* All links in dark content sections */
    .content-section a:not(.btn):not(.news-link),
    section[style*="background: rgba(0"] a:not(.btn):not(.news-link) {
      color: #93c5fd !important;
    }
    .content-section a:not(.btn):not(.news-link):hover,
    section[style*="background: rgba(0"] a:not(.btn):not(.news-link):hover {
      color: #bfdbfe !important;
    }

    /* Temporarily disable animation to debug content visibility */
    /* Will re-enable once content is confirmed visible */

    .section-title {
      font-size: clamp(36px, 5vw, 56px);
      font-weight: 900;
      margin-bottom: 16px;
      line-height: 1.2;
      letter-spacing: -0.02em;
    }

    .section-subtitle {
      font-size: 20px;
      color: rgba(255, 255, 255, 0.7);
      margin-bottom: 60px;
      line-height: 1.6;
    }

    /* Intro Section */
    .intro-content {
      font-size: 18px;
      line-height: 1.8;
      color: rgba(255, 255, 255, 0.9);
    }

    .intro-content p {
      margin-bottom: 24px;
      max-width: 80ch;
    }

    .intro-content p:last-child {
      margin-bottom: 0;
    }

    .intro-content a {
      color: #667eea;
      text-decoration: none;
      border-bottom: 1px solid rgba(102, 126, 234, 0.3);
      transition: border-color 0.3s;
    }

    .intro-content a:hover {
      border-color: #667eea;
    }

    /* Role/Items Grid */
    .items-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 30px;
      margin-bottom: 40px;
    }

    .item-card {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 16px;
      padding: 32px;
      transition: transform 0.3s, background-color 0.3s, border-color 0.3s;
      opacity: 1;
      transform: translateY(0);
      will-change: transform;
    }

    .item-card:hover {
      background: rgba(255, 255, 255, 0.08);
      border-color: rgba(255, 255, 255, 0.2);
      transform: translateY(-4px);
    }

    .item-card h3 {
      font-size: 22px;
      font-weight: 700;
      margin-bottom: 12px;
      color: #fff;
    }

    .item-card p {
      font-size: 15px;
      line-height: 1.8;
      color: rgba(255, 255, 255, 0.8);
      margin-bottom: 12px;
    }

    .item-card p:last-child {
      margin-bottom: 0;
    }

    .summary-text {
      font-size: 17px;
      line-height: 1.8;
      color: rgba(255, 255, 255, 0.85);
      font-style: italic;
      padding: 24px;
      background: rgba(102, 126, 234, 0.1);
      border-left: 4px solid #667eea;
      border-radius: 8px;
      margin-top: 40px;
    }

    /* Top Agents */
    .agents-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
      gap: 24px;
    }

    .agent-card {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 16px;
      padding: 28px;
      transition: transform 0.3s, background-color 0.3s, border-color 0.3s;
      opacity: 1;
      transform: translateY(0);
      will-change: transform;
    }

    .agent-card:hover {
      background: rgba(255, 255, 255, 0.08);
      border-color: rgba(102, 126, 234, 0.5);
      transform: translateY(-4px);
    }

    .agent-name {
      font-size: 24px;
      font-weight: 800;
      margin-bottom: 12px;
      background: linear-gradient(135deg, #fff, #f093fb);
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .agent-meta {
      display: flex;
      gap: 16px;
      margin-bottom: 16px;
      font-size: 13px;
      color: rgba(255, 255, 255, 0.6);
    }

    .agent-meta span {
      background: rgba(102, 126, 234, 0.2);
      padding: 4px 12px;
      border-radius: 12px;
      font-weight: 600;
    }

    .agent-description {
      font-size: 15px;
      line-height: 1.7;
      color: rgba(255, 255, 255, 0.8);
    }

    /* News/Articles Section */
    .news-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 32px;
      margin-top: 40px;
    }

    .news-card {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 16px;
      padding: 32px;
      transition: transform 0.4s cubic-bezier(0.23, 1, 0.32, 1), background-color 0.4s, border-color 0.4s;
      opacity: 1;
      transform: translateY(0);
      will-change: transform;
    }

    .news-card:hover {
      background: rgba(255, 255, 255, 0.08);
      border-color: rgba(102, 126, 234, 0.4);
      transform: translateY(-8px);
    }

    .news-date {
      font-size: 13px;
      color: rgba(255, 255, 255, 0.5);
      font-weight: 600;
      margin-bottom: 12px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .news-title {
      font-size: 22px;
      font-weight: 700;
      margin-bottom: 16px;
      color: #fff;
      line-height: 1.3;
    }

    .news-excerpt {
      font-size: 15px;
      line-height: 1.7;
      color: rgba(255, 255, 255, 0.75);
      margin-bottom: 20px;
    }

    .news-link {
      color: #667eea;
      text-decoration: none;
      font-weight: 600;
      font-size: 14px;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      transition: color 0.3s, gap 0.3s;
    }

    .news-link:hover {
      color: #f093fb;
      gap: 12px;
    }

    /* Phases/Timeline */
    .phases-list {
      display: flex;
      flex-direction: column;
      gap: 32px;
      margin-bottom: 40px;
    }

    .phase-item {
      background: rgba(255, 255, 255, 0.05);
      border-left: 4px solid #667eea;
      border-radius: 12px;
      padding: 28px;
      transition: background-color 0.3s, border-color 0.3s;
      opacity: 1;
      transform: translateY(0);
    }

    .phase-item:hover {
      background: rgba(255, 255, 255, 0.08);
      border-left-color: #f093fb;
    }

    .phase-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
      flex-wrap: wrap;
      gap: 12px;
    }

    .phase-name {
      font-size: 22px;
      font-weight: 700;
      color: #fff;
    }

    .phase-duration {
      font-size: 14px;
      font-weight: 600;
      color: #667eea;
      background: rgba(102, 126, 234, 0.2);
      padding: 6px 16px;
      border-radius: 12px;
    }

    .phase-description {
      font-size: 15px;
      line-height: 1.7;
      color: rgba(255, 255, 255, 0.8);
    }

    /* Fee Structures */
    .fee-section {
      margin-bottom: 48px;
    }

    .fee-section h3 {
      font-size: 28px;
      font-weight: 700;
      margin-bottom: 24px;
      color: #fff;
    }

    .fee-table {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 16px;
      overflow: hidden;
    }

    .fee-row {
      display: grid;
      grid-template-columns: 2fr 1fr;
      padding: 20px 28px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      transition: background 0.3s;
    }

    .fee-row:last-child {
      border-bottom: none;
    }

    .fee-row:hover {
      background: rgba(255, 255, 255, 0.08);
    }

    .fee-label {
      font-weight: 600;
      color: rgba(255, 255, 255, 0.9);
    }

    .fee-value {
      font-weight: 700;
      color: #667eea;
      text-align: right;
    }

    /* FAQ Section */
    .faq-list {
      display: flex;
      flex-direction: column;
      gap: 24px;
    }

    .faq-item {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 16px;
      padding: 32px;
      transition: background-color 0.3s, border-color 0.3s;
      opacity: 1;
      transform: translateY(0);
    }

    .faq-item:hover {
      background: rgba(255, 255, 255, 0.08);
      border-color: rgba(255, 255, 255, 0.2);
    }

    .faq-question {
      font-size: 20px;
      font-weight: 700;
      color: #fff;
      margin-bottom: 20px;
      line-height: 1.4;
    }

    .faq-answer {
      font-size: 16px;
      line-height: 2;
      color: rgba(255, 255, 255, 0.85);
      white-space: pre-line;
      max-width: 75ch;
    }

    .faq-answer p {
      margin-bottom: 20px;
      line-height: 2;
    }

    .faq-answer p:last-child {
      margin-bottom: 0;
    }

    /* References Section */
    .references-list {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .reference-item {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      padding: 24px;
      transition: transform 0.3s, background-color 0.3s, border-color 0.3s;
      opacity: 1;
      transform: translateY(0);
      will-change: transform;
    }

    .reference-item:hover {
      background: rgba(255, 255, 255, 0.08);
      border-color: rgba(102, 126, 234, 0.5);
      transform: translateX(8px);
    }

    .reference-title {
      font-size: 18px;
      font-weight: 700;
      margin-bottom: 8px;
    }

    .reference-title a {
      color: #fff;
      text-decoration: none;
      transition: color 0.3s;
    }

    .reference-title a:hover {
      color: #667eea;
    }

    .reference-description {
      font-size: 14px;
      line-height: 1.6;
      color: rgba(255, 255, 255, 0.7);
    }

    /* Criteria/Red Flags */
    .red-flags {
      background: rgba(239, 68, 68, 0.1);
      border: 1px solid rgba(239, 68, 68, 0.3);
      border-radius: 12px;
      padding: 24px;
      margin-top: 40px;
    }

    .red-flags h3 {
      color: #ef4444;
      font-size: 22px;
      font-weight: 700;
      margin-bottom: 16px;
    }

    .red-flags ul {
      list-style: none;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 12px;
    }

    .red-flags li {
      color: rgba(255, 255, 255, 0.8);
      font-size: 15px;
      padding-left: 24px;
      position: relative;
    }

    .red-flags li::before {
      content: '⚠️';
      position: absolute;
      left: 0;
    }

    @media (max-width: 768px) {
      nav { padding: 16px 20px; }

      /* Show hamburger menu on mobile */
      .hamburger {
        display: flex;
      }

      /* Mobile nav menu */
      .nav-links {
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        flex-direction: column;
        gap: 0 !important;
        background: rgba(0, 0, 0, 0.98);
        backdrop-filter: blur(20px);
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        padding: 20px;
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.3s ease;
        display: flex !important;
      }

      .nav-links.active {
        max-height: 500px;
      }

      .nav-links a {
        padding: 12px 0;
        border-bottom: 1px solid rgba(255, 255, 255, 0.05);
      }

      .nav-links li:last-child a {
        border-bottom: none;
      }

      /* Hide dropdown on mobile */
      .dropdown {
        position: static;
        background: rgba(255, 255, 255, 0.05);
        opacity: 0;
        visibility: hidden;
        max-height: 0;
        overflow: hidden;
        transform: none;
        margin: 0;
        padding: 0;
        border: none;
        transition: all 0.3s ease;
      }

      .nav-item:hover .dropdown {
        opacity: 0;
        visibility: hidden;
      }

      .nav-item.active .dropdown {
        opacity: 1;
        visibility: visible;
        max-height: 400px;
        padding: 12px 0;
        margin-top: 0;
      }

      .hero h1 { font-size: 42px; }
      .hero-subtitle { font-size: 16px; }

      .stats-section, .companies-section, .services-section, .cta-section {
        padding: 80px 20px;
      }

      .content-section {
        padding: 60px 20px;
      }

      .section-title {
        font-size: 32px;
      }

      .section-subtitle {
        font-size: 16px;
      }

      /* Agents grid fully responsive on mobile */
      .companies-grid {
        grid-template-columns: 1fr !important;
        gap: 24px !important;
        margin: 0 -20px;
        padding: 0 20px;
      }

      /* Center company card images on mobile */
      .company-card {
        padding: 24px !important;
        overflow: hidden;
      }

      .company-image-container {
        margin: -24px -24px 16px -24px !important;
        width: calc(100% + 48px) !important;
        border-radius: 16px 16px 0 0 !important;
      }

      .company-card img {
        object-position: center center !important;
      }

      .company-name {
        font-size: 18px !important;
      }

      .company-description {
        font-size: 14px !important;
      }

      .portfolio-grid { grid-template-columns: 1fr; }
      .portfolio-item { height: 50vh; min-height: 300px; }
      .services-grid { grid-template-columns: 1fr; }
      .agents-grid { grid-template-columns: 1fr; }
      .items-grid { grid-template-columns: 1fr; }
      .fee-row { grid-template-columns: 1fr; gap: 8px; }
      .fee-value { text-align: left; }

      /* Make gradients more visible on mobile */
      .content-section.gradient,
      .content-section.gradient-alt {
        background-size: 200% 200%;
      }

      /* Adjust background image opacity for mobile */
      .content-section.has-background::before {
        opacity: 0.1;
      }

      .fullwidth-image-section {
        height: 60vh;
      }

      .cta-section h2 {
        font-size: 36px;
      }

      .cta-section p {
        font-size: 18px;
      }

      /* News section responsive - Featured panels (2 to 1) */
      div[style*="grid-template-columns: 1fr 1fr"][style*="margin-bottom: 40px"] {
        grid-template-columns: 1fr !important;
        gap: 24px !important;
      }

      /* News section responsive - Small panels (3 columns to 1) */
      div[style*="repeat(3, 1fr)"][style*="margin-bottom: 60px"] {
        grid-template-columns: 1fr !important;
        gap: 24px !important;
      }

      .featured-news-panel {
        min-height: auto;
      }

      .featured-news-panel img {
        height: 240px !important;
      }

      .featured-news-panel h3 {
        font-size: 24px !important;
      }

      .featured-news-panel p {
        font-size: 14px !important;
      }

      .news-panel-small {
        min-height: auto;
      }

      .news-panel-small img {
        height: 160px !important;
      }

      .news-panel-small h4 {
        font-size: 16px !important;
      }
    }

    /* Article content styles for database HTML with Tailwind classes */
    .article-content {
      color: #fff !important;
    }
    .article-content p {
      margin-bottom: 1rem;
      color: #fff !important;
    }
    .article-content .text-lg { font-size: 1.125rem; }
    .article-content .text-2xl { font-size: 1.5rem; }
    .article-content .text-gray-700,
    .article-content .text-gray-600,
    .article-content .text-gray-900,
    .article-content p[class*="text-gray"] {
      color: #fff !important;
    }
    .article-content .text-blue-600 { color: #93c5fd !important; }
    .article-content .text-blue-800:hover, .article-content a:hover { color: #bfdbfe !important; }
    .article-content .leading-relaxed { line-height: 1.625; }
    .article-content .font-bold { font-weight: 700; }
    .article-content .underline { text-decoration: underline; }
    .article-content .italic { font-style: italic; }
    .article-content .mb-4 { margin-bottom: 1rem; }
    .article-content .mb-6 { margin-bottom: 1.5rem; }
    .article-content .mt-8 { margin-top: 2rem; }
    .article-content .my-6 { margin-top: 1.5rem; margin-bottom: 1.5rem; }
    .article-content .pl-4 { padding-left: 1rem; }
    .article-content .border-l-4 { border-left: 4px solid; }
    .article-content .border-blue-500 { border-color: #93c5fd; }
    .article-content blockquote {
      border-left: 4px solid #93c5fd;
      padding-left: 1rem;
      margin: 1.5rem 0;
      font-style: italic;
      color: #e0e0e0 !important;
    }
    .article-content h2 {
      font-size: 1.5rem;
      font-weight: 700;
      color: #fff !important;
      margin-top: 2rem;
      margin-bottom: 1rem;
    }
    .article-content h2[class*="text-gray"],
    .article-content h2.text-gray-900 {
      color: #fff !important;
    }
    .article-content ul, .article-content ol {
      margin-bottom: 1.5rem;
      padding-left: 1.5rem;
      color: #fff !important;
    }
    .article-content .list-disc { list-style-type: disc; }
    .article-content .list-inside { list-style-position: inside; }
    .article-content .space-y-2 > * + * { margin-top: 0.5rem; }
    .article-content li { margin-bottom: 0.5rem; color: #fff !important; }
    .article-content a {
      color: #93c5fd !important;
      text-decoration: underline;
    }
    .article-content a:hover {
      color: #bfdbfe !important;
    }
  </style>

  <script>
    // Hamburger Menu Toggle
    document.addEventListener('DOMContentLoaded', function() {
      const hamburger = document.getElementById('hamburger-menu');
      const navMenu = document.getElementById('nav-menu');
      const navItems = navMenu.querySelectorAll('.nav-item');

      if (hamburger && navMenu) {
        hamburger.addEventListener('click', function() {
          hamburger.classList.toggle('active');
          navMenu.classList.toggle('active');
        });

        // Close menu when link is clicked
        const navLinks = navMenu.querySelectorAll('a');
        navLinks.forEach(link => {
          link.addEventListener('click', function() {
            // Don't close if clicking on Agents dropdown toggle
            if (!this.parentElement.classList.contains('nav-item')) {
              hamburger.classList.remove('active');
              navMenu.classList.remove('active');
            }
          });
        });

        // Toggle dropdown on mobile
        navItems.forEach(item => {
          const link = item.querySelector('a');
          link.addEventListener('click', function(e) {
            if (window.innerWidth <= 768) {
              e.preventDefault();
              item.classList.toggle('active');
            }
          });
        });
      }
    });
  </script>
</head>
<body style="margin: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, Roboto, sans-serif; background: #000; color: #fff; line-height: 1.6;">
  <!-- Navigation -->
  <nav style="position: fixed; top: 0; left: 0; right: 0; z-index: 1000; padding: 24px 60px; display: flex; justify-content: space-between; align-items: center; background: rgba(0, 0, 0, 0.5); backdrop-filter: blur(20px); border-bottom: 1px solid rgba(255, 255, 255, 0.1);">
    <a href="/" class="logo" style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif; font-size: 20px; font-weight: 700; color: #fff; text-decoration: none;">Placement Quest</a>
    <button class="hamburger" id="hamburger-menu" aria-label="Toggle menu">
      <span></span>
      <span></span>
      <span></span>
    </button>
    <ul class="nav-links" id="nav-menu">
      <li><a href="/private-equity-placement-agent-news">News</a></li>
      <li class="nav-item">
        <a href="/private-equity-placement-agents-list">Agents</a>
        <div class="dropdown">
          <a href="/private-equity-placement-agents-list">All Regions & Countries</a>
          <div class="dropdown-divider"></div>
          <a href="/top-private-equity-placement-agents-north-america">North America</a>
          <a href="/top-private-equity-placement-agents-europe">Europe</a>
          <a href="/top-private-equity-placement-agents-asia-pacific">Asia Pacific</a>
          <a href="/top-private-equity-placement-agents-latin-america">Latin America</a>
          <a href="/top-private-equity-placement-agents-africa">Africa</a>
          <a href="/top-private-equity-placement-agents-middle-east">Middle East</a>
          <div class="dropdown-divider"></div>
          <a href="/top-private-equity-placement-agents-us">United States</a>
          <a href="/top-private-equity-placement-agents-uk">United Kingdom</a>
          <a href="/top-private-equity-placement-agents-singapore">Singapore</a>
          <div class="dropdown-divider"></div>
          <a href="/venture-capital-placement-agents">VC Agents</a>
          <a href="/private-credit-placement-agents">Credit Agents</a>
          <a href="/real-estate-private-equity-placement-agents">Real Estate PE</a>
        </div>
      </li>
    </ul>
  </nav>

  <!-- Hero with Carousel -->
  <section class="hero">
    <div class="hero-carousel">
      {heroCarouselItems.map((item, index) => (
        item.type === 'video' ? (
          <video
            id={`hero-carousel-${index}`}
            class={`hero-carousel-item hero-video ${index === 0 ? 'active' : ''}`}
            autoplay={index === 0}
            loop
            muted
            playsinline
            preload="none"
            data-carousel-index={index}
            aria-label="Decorative background video showing financial district"
          >
            <track kind="captions" src="" label="No captions (decorative video)" default />
          </video>
        ) : (
          <div
            id={`hero-carousel-${index}`}
            class={`hero-carousel-item hero-image ${index === 0 ? 'active' : ''}`}
            style={`background-image: url('${item.src}');`}
            data-carousel-index={index}
          ></div>
        )
      ))}
    </div>
  </section>

  <!-- Simple Inline Cookie Notice (GDPR compliant, non-blocking) -->
  <div id="cookie-notice" style="display: none; background: linear-gradient(90deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1)); border-bottom: 1px solid rgba(102, 126, 234, 0.2); padding: 12px 20px;">
    <div style="max-width: 1200px; margin: 0 auto; display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 12px;">
      <p style="color: rgba(255, 255, 255, 0.8); font-size: 14px; margin: 0;">
        We use essential cookies only for site functionality.
        <a href="/privacy" style="color: #667eea; text-decoration: underline;">Privacy Policy</a>
      </p>
      <div style="display: flex; gap: 8px;">
        <button id="cookie-accept" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; padding: 8px 16px; border-radius: 6px; font-size: 13px; font-weight: 600; cursor: pointer;">Accept</button>
        <button id="cookie-decline" style="background: transparent; color: rgba(255, 255, 255, 0.7); border: 1px solid rgba(255, 255, 255, 0.3); padding: 8px 16px; border-radius: 6px; font-size: 13px; cursor: pointer;">Decline</button>
      </div>
    </div>
  </div>
  <script>
    (function() {
      const notice = document.getElementById('cookie-notice');
      const accepted = localStorage.getItem('cookie-consent');
      if (!accepted && notice) {
        notice.style.display = 'block';
        document.getElementById('cookie-accept').onclick = function() {
          localStorage.setItem('cookie-consent', 'accepted');
          notice.style.display = 'none';
        };
        document.getElementById('cookie-decline').onclick = function() {
          localStorage.setItem('cookie-consent', 'declined');
          notice.style.display = 'none';
        };
      }
    })();
  </script>

  <!-- Welcome Section - Single Slim Panel -->
  <section class="welcome-section" style="padding: 60px 40px; background: linear-gradient(180deg, #000 0%, rgba(102, 126, 234, 0.1) 50%, #000 100%);">
    <div style="max-width: 1000px; margin: 0 auto;">
      <!-- Single Panel Intro -->
      <div style="background: linear-gradient(135deg, rgba(102, 126, 234, 0.15) 0%, rgba(118, 75, 162, 0.15) 100%); border: 2px solid rgba(102, 126, 234, 0.3); border-radius: 20px; padding: 40px 48px; text-align: center; position: relative; overflow: hidden;">
        <div style="position: absolute; top: -30px; right: -30px; width: 100px; height: 100px; background: radial-gradient(circle, rgba(240, 147, 251, 0.2) 0%, transparent 70%); border-radius: 50%;"></div>
        <div style="position: absolute; bottom: -30px; left: -30px; width: 100px; height: 100px; background: radial-gradient(circle, rgba(102, 126, 234, 0.2) 0%, transparent 70%); border-radius: 50%;"></div>

        <div class="welcome-text" style="font-size: clamp(32px, 5vw, 56px); font-weight: 900; line-height: 1.1; margin-bottom: 8px; background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%); background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent; animation: welcomeFade 1.5s ease-out;">
          Welcome to Placement Quest
        </div>

        <h1 style="font-size: clamp(18px, 2.5vw, 24px); font-weight: 600; margin-bottom: 12px; color: #fff; line-height: 1.3;">
          Top Private Equity Placement Agents
        </h1>

        <p style="font-size: 15px; line-height: 1.7; color: rgba(255, 255, 255, 0.75); margin: 0 auto; max-width: 700px;">
          Discover the world's leading placement agents, compare firms side-by-side, and find the perfect fundraising partner for your fund.
        </p>
      </div>
    </div>
  </section>

  <!-- Recent Placement News - Funky Design -->
  {articles && articles.length > 0 && (
    <section class="content-section gradient animated" style="padding: 100px 20px; background: linear-gradient(180deg, #000 0%, rgba(102, 126, 234, 0.08) 50%, #000 100%);">
      <div style="width: 100%;">
        <!-- Section Header -->
        <div style="text-align: center; margin-bottom: 80px;">
          <div style="display: inline-block; background: linear-gradient(135deg, #667eea 0%, #f093fb 100%); padding: 8px 24px; border-radius: 50px; margin-bottom: 24px;">
            <span style="font-size: 14px; font-weight: 700; color: #fff; text-transform: uppercase; letter-spacing: 2px;">Latest Updates</span>
          </div>
          <div class="section-title-styled" style="font-size: clamp(40px, 7vw, 64px); font-weight: 900; margin-bottom: 16px; background: linear-gradient(135deg, #fff 0%, rgba(255, 255, 255, 0.8) 100%); background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
            Recent Placement News
          </div>
          <p style="font-size: 18px; color: rgba(255, 255, 255, 0.7); max-width: 700px; margin: 0 auto;">
            Stay ahead with the latest insights and trends from the private equity fundraising world
          </p>
        </div>

        <div style="max-width: 1600px; margin: 0 auto; padding: 0 20px;">
          <!-- Two Featured Panels -->
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 32px; margin-bottom: 40px;">
            {articles.slice(0, 2).map((article: any, index: number) => (
              <a href={`/${article.slug}`} style="text-decoration: none; display: block;">
                <div style={`background: ${index === 0 ? 'linear-gradient(135deg, rgba(102, 126, 234, 0.25) 0%, rgba(118, 75, 162, 0.25) 100%)' : 'linear-gradient(135deg, rgba(240, 147, 251, 0.2) 0%, rgba(102, 126, 234, 0.2) 100%)'}; border: 2px solid ${index === 0 ? 'rgba(102, 126, 234, 0.5)' : 'rgba(240, 147, 251, 0.4)'}; border-radius: 24px; padding: 0; overflow: hidden; transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1); height: 100%; display: flex; flex-direction: column;`} class="featured-news-panel">
                  {(article.mux_playback_id || article.thumbnail_url) && (
                    <div style="width: 100%; height: 340px; overflow: hidden; flex-shrink: 0; position: relative;">
                      {/* Static thumbnail as placeholder until video loads */}
                      <img
                        src={article.thumbnail_url}
                        srcset={article.thumbnail_srcset}
                        sizes="(max-width: 640px) 200px, 300px"
                        alt={article.title}
                        width="300"
                        height="340"
                        class="news-thumbnail"
                        style="width: 100%; height: 100%; object-fit: cover; position: absolute; top: 0; left: 0;"
                        loading={index === 0 ? "eager" : "lazy"}
                        fetchpriority={index === 0 ? "high" : "auto"}
                      />
                      {/* HLS video - lazy loaded, replaces thumbnail when ready */}
                      {article.mux_playback_id && (
                        <video
                          class="news-video"
                          data-playback-id={article.mux_playback_id}
                          autoplay
                          loop
                          muted
                          playsinline
                          preload="none"
                          style="width: 100%; height: 100%; object-fit: cover; position: absolute; top: 0; left: 0; opacity: 0; transition: opacity 0.3s;"
                        >
                          <track kind="captions" src="" label="No captions" default />
                        </video>
                      )}
                    </div>
                  )}
                  <div style="padding: 40px 36px; flex-grow: 1; display: flex; flex-direction: column; justify-content: space-between;">
                    <div>
                      <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px;">
                        <div style={`width: 8px; height: 8px; border-radius: 50%; background: ${index === 0 ? '#667eea' : '#f093fb'}; animation: pulse 2s infinite;`}></div>
                        <span style="font-size: 12px; color: rgba(255, 255, 255, 0.6); text-transform: uppercase; letter-spacing: 1px;">
                          {new Date(article.published_at).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}
                        </span>
                      </div>
                      <div class="news-title" style="font-size: 28px; font-weight: 800; color: #fff; margin-bottom: 16px; line-height: 1.3;">
                        {article.title}
                      </div>
                      {article.excerpt && (
                        <p style="font-size: 16px; color: rgba(255, 255, 255, 0.75); line-height: 1.6; margin: 0;">
                          {article.excerpt.substring(0, 150)}...
                        </p>
                      )}
                    </div>
                  </div>
                </div>
              </a>
            ))}
          </div>

          <!-- One Additional News Panel (reduced from 6 for SEO - total 3 cards) -->
          <div style="display: grid; grid-template-columns: repeat(1, 1fr); gap: 28px; margin-bottom: 60px; max-width: 400px; margin-left: auto; margin-right: auto;">
            {articles.slice(2, 3).map((article: any, index: number) => (
              <a href={`/${article.slug}`} style="text-decoration: none; display: block;">
                <div style="background: rgba(255, 255, 255, 0.04); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 20px; padding: 0; overflow: hidden; height: 100%; display: flex; flex-direction: column;" class="news-panel-small">
                  {(article.mux_playback_id || article.thumbnail_url) && (
                    <div style="width: 100%; height: 200px; overflow: hidden; flex-shrink: 0; position: relative;">
                      {/* Static thumbnail as placeholder */}
                      <img
                        src={article.thumbnail_url}
                        srcset={article.thumbnail_srcset}
                        sizes="(max-width: 640px) 200px, 300px"
                        alt={article.title}
                        width="300"
                        height="200"
                        class="news-thumbnail"
                        style="width: 100%; height: 100%; object-fit: cover; position: absolute; top: 0; left: 0;"
                        loading="lazy"
                      />
                      {/* HLS video - lazy loaded */}
                      {article.mux_playback_id && (
                        <video
                          class="news-video"
                          data-playback-id={article.mux_playback_id}
                          autoplay
                          loop
                          muted
                          playsinline
                          preload="none"
                          style="width: 100%; height: 100%; object-fit: cover; position: absolute; top: 0; left: 0; opacity: 0; transition: opacity 0.3s;"
                        >
                          <track kind="captions" src="" label="No captions" default />
                        </video>
                      )}
                    </div>
                  )}
                  <div style="padding: 28px; flex-grow: 1; display: flex; flex-direction: column; justify-content: flex-start;">
                    <div style="font-size: 11px; color: rgba(255, 255, 255, 0.5); margin-bottom: 12px; text-transform: uppercase; letter-spacing: 0.5px;">
                      {new Date(article.published_at).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}
                    </div>
                    <div class="news-title-small" style="font-size: 18px; font-weight: 700; color: #fff; margin: 0; line-height: 1.4;">
                      {article.title.length > 60 ? article.title.substring(0, 60) + '...' : article.title}
                    </div>
                  </div>
                </div>
              </a>
            ))}
          </div>
        </div>

        <!-- Funky More News Button -->
        <div style="text-align: center;">
          <a href="/private-equity-placement-agent-news" style="display: inline-flex; align-items: center; gap: 12px; background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%); padding: 18px 48px; border-radius: 60px; text-decoration: none; font-size: 16px; font-weight: 700; color: #fff; box-shadow: 0 8px 32px rgba(102, 126, 234, 0.4); transition: transform 0.2s, box-shadow 0.2s; position: relative; overflow: hidden;" class="more-news-btn">
            <span style="position: relative; z-index: 1;">More News</span>
            <svg style="width: 20px; height: 20px; position: relative; z-index: 1;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
            </svg>
          </a>
        </div>
      </div>

      <!-- Funky hover styles -->
      <style>
        .featured-news-panel:hover {
          transform: translateY(-8px);
          box-shadow: 0 20px 60px rgba(102, 126, 234, 0.3);
        }
        .featured-news-panel:hover img {
          transform: scale(1.05);
        }
        .news-panel-small:hover {
          background: rgba(255, 255, 255, 0.08) !important;
          border-color: rgba(102, 126, 234, 0.4) !important;
          transform: translateY(-4px);
        }
        .news-panel-small:hover img {
          transform: scale(1.08);
        }
        .more-news-btn:hover {
          transform: translateY(-4px) scale(1.02);
          box-shadow: 0 12px 48px rgba(240, 147, 251, 0.5);
        }
        .more-news-btn::before {
          content: '';
          position: absolute;
          top: 0;
          left: -100%;
          width: 100%;
          height: 100%;
          background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
          transition: left 0.5s ease;
        }
        .more-news-btn:hover::before {
          left: 100%;
        }
        @media (max-width: 1024px) {
          .content-section.gradient > div > div:nth-child(2) {
            grid-template-columns: 1fr !important;
          }
          .content-section.gradient > div > div:nth-child(3) {
            grid-template-columns: repeat(2, 1fr) !important;
          }
        }
        @media (max-width: 640px) {
          .content-section.gradient > div > div:nth-child(3) {
            grid-template-columns: 1fr !important;
          }
        }
      </style>
    </section>
  )}

  <!-- Comparison Table - Moved Up for Quick Access -->
  <div id="comparison-table">
    <PlacementAgentsComparisonTable />
  </div>

  <!-- Top Companies Section -->
  <section id="top-agents" class="companies-section">
    <div class="companies-content">
      <div class="section-header">
        <h2 style="font-size: 36px;">Top Private Equity Placement Agents Directory 2025</h2>
        <p style="font-size: 18px; line-height: 1.8; margin-bottom: 24px; font-weight: 600;">
          Our curated private equity placement agents list features the world's leading fundraising advisors, including firms ranked in <a href="https://www.preqin.com" target="_blank" rel="noopener" style="color: #667eea; text-decoration: underline;">Preqin's 2025 Global Placement Agent Rankings</a>. These elite agencies serve as the vital bridge between General Partners (GPs) seeking capital and institutional Limited Partners (LPs).
        </p>

        {(visitorCountryName || visitorRegion) && (
          <div style="display: inline-flex; align-items: center; gap: 8px; background: linear-gradient(135deg, rgba(102, 126, 234, 0.2) 0%, rgba(240, 147, 251, 0.2) 100%); padding: 10px 20px; border-radius: 50px; margin-bottom: 24px; border: 1px solid rgba(102, 126, 234, 0.3);">
            <span style="font-size: 16px;">📍</span>
            <span style="font-size: 14px; font-weight: 600; color: rgba(255, 255, 255, 0.9);">
              Showing {visitorCountryName || visitorRegion} agents first
            </span>
          </div>
        )}

        <div style="background: rgba(102, 126, 234, 0.1); border-left: 4px solid #667eea; padding: 24px; border-radius: 12px; margin-bottom: 32px;">
          <div class="callout-title" style="font-size: 20px; font-weight: 700; margin-bottom: 16px; color: #667eea;">
            What Defines a Top Placement Agent? Key Criteria
          </div>
          <ol style="list-style-position: inside; color: rgba(255, 255, 255, 0.9); line-height: 1.9; font-size: 16px; counter-reset: item; list-style: none; padding-left: 0;">
            <li style="counter-increment: item; margin-bottom: 12px; padding-left: 32px; position: relative;">
              <span style="position: absolute; left: 0; font-weight: 700; color: #667eea;">1.</span>
              <strong>Proven Track Record:</strong> Top-ranked firms like <a href="/private-equity-placement-agents-list/campbell-lutyens" style="color: #fff; text-decoration: underline;">Campbell Lutyens</a> (#1 in Preqin 2025) and <a href="/private-equity-placement-agents-list/pjt-park-hill" style="color: #fff; text-decoration: underline;">PJT Park Hill</a> have closed billions in capital across multiple fund cycles
            </li>
            <li style="counter-increment: item; margin-bottom: 12px; padding-left: 32px; position: relative;">
              <span style="position: absolute; left: 0; font-weight: 700; color: #667eea;">2.</span>
              <strong>LP Network Depth:</strong> Access to 500-1,000+ institutional investors including pension funds, sovereign wealth funds, insurance companies, and family offices globally
            </li>
            <li style="counter-increment: item; margin-bottom: 12px; padding-left: 32px; position: relative;">
              <span style="position: absolute; left: 0; font-weight: 700; color: #667eea;">3.</span>
              <strong>Strategy Expertise:</strong> Specialized knowledge across buyout, <a href="/venture-capital-placement-agents" style="color: #fff; text-decoration: underline;">venture capital</a>, <a href="/private-credit-placement-agents" style="color: #fff; text-decoration: underline;">private credit</a>, infrastructure, and <a href="/real-estate-private-equity-placement-agents" style="color: #fff; text-decoration: underline;">real estate</a>
            </li>
            <li style="counter-increment: item; margin-bottom: 12px; padding-left: 32px; position: relative;">
              <span style="position: absolute; left: 0; font-weight: 700; color: #667eea;">4.</span>
              <strong>Geographic Reach:</strong> Leading firms maintain offices across <a href="/top-private-equity-placement-agents-north-america" style="color: #fff; text-decoration: underline;">North America</a>, <a href="/top-private-equity-placement-agents-europe" style="color: #fff; text-decoration: underline;">Europe</a>, and <a href="/top-private-equity-placement-agents-asia-pacific" style="color: #fff; text-decoration: underline;">Asia Pacific</a> to access global LP pools
            </li>
            <li style="counter-increment: item; margin-bottom: 12px; padding-left: 32px; position: relative;">
              <span style="position: absolute; left: 0; font-weight: 700; color: #667eea;">5.</span>
              <strong>Regulatory Compliance:</strong> Full regulatory registration (SEC, FCA, etc.) and adherence to industry best practices including ILPA guidelines
            </li>
          </ol>
        </div>

        <p style="font-size: 16px; line-height: 1.8; color: rgba(255, 255, 255, 0.85); margin-bottom: 16px;">
          According to Preqin's 2025 rankings, the global placement agent market is dominated by a select group of firms that collectively facilitate over $100 billion in annual fundraising. <a href="/boutique-private-equity-placement-agents" style="color: #667eea; text-decoration: underline;">Boutique placement agents</a> complement larger firms by offering specialized regional or strategy-specific expertise.
        </p>

        <p style="font-size: 15px; line-height: 1.7; color: rgba(255, 255, 255, 0.75); margin-bottom: 32px;">
          Our directory includes firms from Preqin's top 50 alongside emerging specialists. Rankings sources: Preqin, Private Equity Marketeer, and industry research.
        </p>

        <div style="padding: 24px; background: linear-gradient(135deg, rgba(102, 126, 234, 0.15) 0%, rgba(118, 75, 162, 0.15) 100%); border-radius: 12px; border: 2px solid rgba(102, 126, 234, 0.4);">
          <div style="font-size: 18px; font-weight: 700; color: #667eea; margin-bottom: 16px;">
            Top Private Equity Placement Agents Directory List
          </div>
          <ol style="list-style-position: inside; color: rgba(255, 255, 255, 0.9); line-height: 1.9; font-size: 15px; columns: 2; column-gap: 40px; padding-left: 0;">
            <li style="margin-bottom: 8px;"><a href="/private-equity-placement-agents-list/campbell-lutyens" style="color: #fff; text-decoration: none;">Campbell Lutyens</a></li>
            <li style="margin-bottom: 8px;"><a href="/private-equity-placement-agents-list/pjt-park-hill" style="color: #fff; text-decoration: none;">PJT Park Hill</a></li>
            <li style="margin-bottom: 8px;"><a href="/private-equity-placement-agents-list/evercore" style="color: #fff; text-decoration: none;">Evercore</a></li>
            <li style="margin-bottom: 8px;"><a href="/private-equity-placement-agents-list/rede-partners" style="color: #fff; text-decoration: none;">Rede Partners</a></li>
            <li style="margin-bottom: 8px;"><a href="/private-equity-placement-agents-list/eaton-partners" style="color: #fff; text-decoration: none;">Eaton Partners</a></li>
            <li style="margin-bottom: 8px;"><a href="/private-equity-placement-agents-list/credit-suisse" style="color: #fff; text-decoration: none;">Credit Suisse</a></li>
            <li style="margin-bottom: 8px;"><a href="/private-equity-placement-agents-list/mvision" style="color: #fff; text-decoration: none;">MVision</a></li>
            <li style="margin-bottom: 8px;"><a href="/private-equity-placement-agents-list/probitas-partners" style="color: #fff; text-decoration: none;">Probitas Partners</a></li>
            <li style="margin-bottom: 8px;"><a href="/private-equity-placement-agents-list/monument-group" style="color: #fff; text-decoration: none;">Monument Group</a></li>
            <li style="margin-bottom: 8px;"><a href="/private-equity-placement-agents-list/lazard" style="color: #fff; text-decoration: none;">Lazard</a></li>
          </ol>
          <p style="font-size: 14px; color: rgba(255, 255, 255, 0.6); margin-top: 16px; margin-bottom: 0;">
            <a href="/private-equity-placement-agents-list" style="color: #667eea; text-decoration: none;">See all 85+ agents →</a>
          </p>
        </div>
      </div>

      {allAgents.length > 0 ? (
        <div class="companies-grid">
          {allAgents.map((company: any, index: number) => (
            <a href={`/private-equity-placement-agents-list/${company.slug}`} aria-label={`View ${company.display_name} profile - Private equity placement agent`} style="text-decoration: none; color: inherit;">
              <div class={`company-card${index >= 20 ? ' hidden-card' : ''}`} data-slug={company.slug} data-image={index >= 20 ? optimizeCloudinaryImage(company.featured_asset_url, 800) : ''}>
                {company.featured_asset_url && index < 20 && (
                  <div class="company-image-container" style="width: 100%; height: 200px; overflow: hidden; margin: -40px -40px 24px -40px; border-radius: 24px 24px 0 0;">
                    <img
                      src={optimizeCloudinaryImage(company.featured_asset_url, 800)}
                      srcset={generateSrcSet(company.featured_asset_url)}
                      sizes="(max-width: 640px) 100vw, (max-width: 1024px) 50vw, 400px"
                      alt={company.display_name}
                      loading={index < 4 ? 'eager' : 'lazy'}
                      decoding="async"
                      width="800"
                      height="200"
                      style="width: 100%; height: 100%; object-fit: cover;"
                    />
                  </div>
                )}
                <div class="company-header">
                  <div>
                    <div class="company-name">{company.display_name}</div>
                    {company.primary_country && (
                      <div class="company-location">🌍 {company.primary_country} · {company.primary_region}</div>
                    )}
                    {company.global_rank && (
                      <div class="company-location">🏆 Rank #{company.global_rank}</div>
                    )}
                  </div>
                </div>
                {company.description && (
                  <p class="company-description">{company.description}</p>
                )}

                {company.specializations && company.specializations.length > 0 && (
                  <div class="company-tags">
                    {company.specializations.slice(0, 3).map((spec: string) => (
                      <span class="tag">{spec}</span>
                    ))}
                  </div>
                )}
                <div style="margin-top: 16px; color: #667eea; font-weight: 600; font-size: 14px;">
                  View Profile →
                </div>
              </div>
            </a>
          ))}
        </div>
      ) : (
        <div class="empty-state">
          <div class="empty-state-title" style="font-size: 24px; font-weight: 700; margin-bottom: 12px;">Coming Soon</div>
          <p>We're currently curating the finest PE fundraising advisors. Check back soon!</p>
        </div>
      )}

      {allAgents.length > 20 && (
        <div id="load-buttons-top" style="text-align: center; margin-top: 48px;">
          <button id="load-all-top-agents" class="btn btn-primary">
            Load All {allAgents.length} Placement Agents
          </button>
        </div>
      )}
    </div>
  </section>

  <!-- Full Article Sections - REMOVED for SEO optimization (content moved to individual article pages) -->

  <!-- PDF Guide CTA Section -->
  <section class="pdf-guide-cta animated">
    <div class="pdf-guide-content">
      <div class="pdf-guide-badge">Free Resource</div>
      <h2 style="font-size: 28px; font-weight: 700; margin-bottom: 12px;">Top Private Equity Placement Agents Resources</h2>
      <div class="guide-subtitle" style="font-size: 22px; font-weight: 600; color: rgba(255, 255, 255, 0.9); margin-bottom: 16px;">Download Our Comprehensive Guide 2025</div>
      <p>
        Get instant access to our 30-page guide featuring leading placement agents, fee structures, selection criteria, market statistics, and expert insights for successful PE fundraising.
      </p>
      <div class="pdf-features">
        <div class="pdf-feature">
          <span class="pdf-icon">🏆</span>
          <span>Featured Top Agents</span>
        </div>
        <div class="pdf-feature">
          <span class="pdf-icon">💰</span>
          <span>Fee Breakdowns</span>
        </div>
        <div class="pdf-feature">
          <span class="pdf-icon">📊</span>
          <span>Market Statistics</span>
        </div>
        <div class="pdf-feature">
          <span class="pdf-icon">✅</span>
          <span>Selection Criteria</span>
        </div>
      </div>
      <a href="/resources/placement-agents-guide" class="btn btn-primary" style="padding: 24px 54px; font-size: 18px;">
        Download Free PDF Guide →
      </a>
    </div>
  </section>


  <!-- Stats - Qualitative Statements (MOVED UP) -->
  <section class="stats-section animated">
    <div class="stats-bg"></div>
    <div class="stats-grid">
      <div class="stat-item">
        <div class="stat-title">Curated<br>Directory</div>
        <div class="stat-label">Comprehensive profiles of leading PE fundraising advisors ranked by capital raising success and LP networks</div>
      </div>
      <div class="stat-item">
        <div class="stat-title">Industry<br>News</div>
        <div class="stat-label">Breaking coverage of fund closes, placement agent moves, and PE fundraising trends</div>
      </div>
      <div class="stat-item">
        <div class="stat-title">Market<br>Analysis</div>
        <div class="stat-label">In-depth reporting on fee structures, regional trends, and the evolving placement agent landscape</div>
      </div>
    </div>
  </section>

  <!-- Role Section - MOVED TO /what-do-placement-agents-do (SEO optimization) -->

  <!-- Portfolio/How It Works/Full-width Image Sections - REMOVED for SEO optimization -->

  <!-- Fee Structures, Selection Criteria - MOVED TO /placement-agent-fees and /choosing-a-placement-agent -->

  <!-- Portfolio Item - Career & Global - REMOVED for SEO optimization -->

  <!-- By Region Section - H3 with keyword -->
  <section class="region-links-section animated" style="padding: 60px 20px; background: linear-gradient(180deg, rgba(102, 126, 234, 0.05) 0%, rgba(0, 0, 0, 0.95) 100%);">
    <div style="max-width: 1200px; margin: 0 auto; text-align: center;">
      <h3 style="font-size: clamp(24px, 4vw, 36px); font-weight: 800; margin-bottom: 24px;">Top Private Equity Placement Agents by Region</h3>
      <p style="font-size: 16px; color: rgba(255, 255, 255, 0.7); margin-bottom: 32px; max-width: 700px; margin-left: auto; margin-right: auto;">
        Explore our comprehensive directory of placement agents across global markets
      </p>
      <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 16px;">
        <a href="/top-private-equity-placement-agents-north-america" class="region-link" style="background: rgba(102, 126, 234, 0.15); border: 1px solid rgba(102, 126, 234, 0.3); padding: 16px 28px; border-radius: 12px; color: #fff; text-decoration: none; font-weight: 600; transition: background-color 0.2s, border-color 0.2s;">Americas</a>
        <a href="/top-private-equity-placement-agents-europe" class="region-link" style="background: rgba(102, 126, 234, 0.15); border: 1px solid rgba(102, 126, 234, 0.3); padding: 16px 28px; border-radius: 12px; color: #fff; text-decoration: none; font-weight: 600; transition: background-color 0.2s, border-color 0.2s;">EMEA</a>
        <a href="/top-private-equity-placement-agents-asia-pacific" class="region-link" style="background: rgba(102, 126, 234, 0.15); border: 1px solid rgba(102, 126, 234, 0.3); padding: 16px 28px; border-radius: 12px; color: #fff; text-decoration: none; font-weight: 600; transition: background-color 0.2s, border-color 0.2s;">APAC</a>
        <a href="/top-private-equity-placement-agents-uk" class="region-link" style="background: rgba(102, 126, 234, 0.15); border: 1px solid rgba(102, 126, 234, 0.3); padding: 16px 28px; border-radius: 12px; color: #fff; text-decoration: none; font-weight: 600; transition: background-color 0.2s, border-color 0.2s;">UK</a>
      </div>
    </div>
  </section>

  <!-- Condensed FAQ Section - H4 with keyword -->
  <section class="faq-condensed animated" style="padding: 60px 20px; background: rgba(0, 0, 0, 0.98);">
    <div style="max-width: 900px; margin: 0 auto;">
      <h4 style="font-size: clamp(22px, 3.5vw, 32px); font-weight: 800; margin-bottom: 32px; text-align: center;">Top Private Equity Placement Agents FAQ</h4>
      <div style="display: flex; flex-direction: column; gap: 20px;">
        <div style="background: rgba(102, 126, 234, 0.1); border-left: 3px solid #667eea; padding: 20px 24px; border-radius: 8px;">
          <div style="font-weight: 700; color: #fff; margin-bottom: 8px;">What is a private equity placement agent?</div>
          <div style="color: rgba(255, 255, 255, 0.75); line-height: 1.6;">A placement agent is an intermediary that helps private equity funds raise capital by connecting fund managers (GPs) with institutional investors (LPs).</div>
        </div>
        <div style="background: rgba(102, 126, 234, 0.1); border-left: 3px solid #667eea; padding: 20px 24px; border-radius: 8px;">
          <div style="font-weight: 700; color: #fff; margin-bottom: 8px;">What fees do placement agents charge?</div>
          <div style="color: rgba(255, 255, 255, 0.75); line-height: 1.6;">Typical fees range from 1-2% of capital raised, with retainer fees of $25,000-$100,000. Larger funds may negotiate lower rates.</div>
        </div>
        <div style="background: rgba(102, 126, 234, 0.1); border-left: 3px solid #667eea; padding: 20px 24px; border-radius: 8px;">
          <div style="font-weight: 700; color: #fff; margin-bottom: 8px;">How do I choose the right placement agent?</div>
          <div style="color: rgba(255, 255, 255, 0.75); line-height: 1.6;">Consider their track record, LP network depth, strategy expertise, geographic reach, and regulatory compliance. Our <a href="/choosing-a-placement-agent" style="color: #667eea;">selection guide</a> provides detailed criteria.</div>
        </div>
      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="cta-section">
    <h2 style="font-size: clamp(32px, 5vw, 48px); font-weight: 900; margin-bottom: 24px; line-height: 1.2;">Top Private Equity Placement Agents Contact</h2>
    <p>
      Explore our directory of top placement agents and stay up-to-date<br>
      with the latest news and insights from the private equity sector
    </p>
    <div class="hero-cta">
      <a href="/private-equity-placement-agents-list" class="btn btn-primary">View Directory</a>
      <a href="/private-equity-placement-agent-news" class="btn btn-secondary">Latest News</a>
    </div>

    <!-- Social Sharing -->
    <div class="social-share" style="margin-top: 48px; display: flex; justify-content: center; gap: 16px; flex-wrap: wrap;">
      <span style="color: rgba(255, 255, 255, 0.6); font-size: 14px; margin-right: 8px; align-self: center;">Share this resource:</span>
      <a href="https://twitter.com/intent/tweet?text=Top%20Private%20Equity%20Placement%20Agents%20List%202025%20-%20Comprehensive%20directory%20of%2085%2B%20placement%20agents&url=https://placement.quest/" target="_blank" rel="noopener" class="social-btn" style="display: inline-flex; align-items: center; gap: 8px; background: rgba(29, 161, 242, 0.2); color: #1DA1F2; padding: 12px 20px; border-radius: 8px; text-decoration: none; font-weight: 600; font-size: 14px; border: 1px solid rgba(29, 161, 242, 0.3); transition: all 0.3s;">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
        Share on X
      </a>
      <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://placement.quest/&title=Top%20Private%20Equity%20Placement%20Agents%20List%202025&summary=Comprehensive%20directory%20of%2085%2B%20top%20private%20equity%20placement%20agents%20worldwide" target="_blank" rel="noopener" class="social-btn" style="display: inline-flex; align-items: center; gap: 8px; background: rgba(10, 102, 194, 0.2); color: #0A66C2; padding: 12px 20px; border-radius: 8px; text-decoration: none; font-weight: 600; font-size: 14px; border: 1px solid rgba(10, 102, 194, 0.3); transition: all 0.3s;">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
        Share on LinkedIn
      </a>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <div class="footer-content">
      <div class="footer-section">
        <div class="footer-title">Placement</div>
        <p style="color: rgba(255, 255, 255, 0.6); margin-top: 12px;">
          Your definitive resource for <a href="/" style="color: #667eea; text-decoration: none;">top private equity placement agents</a> and capital raising intelligence.
        </p>
        <p style="margin-top: 12px; color: rgba(255, 255, 255, 0.6); font-size: 14px;">
          Browse our comprehensive <a href="/" style="color: #667eea; text-decoration: none;">placement agents list</a> featuring 85+ firms worldwide.
        </p>
      </div>

      <div class="footer-section">
        <div class="footer-title">Resources</div>
        <ul class="footer-links">
          <li><a href="/private-equity-placement-agent-news">PE Fundraising News</a></li>
          <li><a href="/private-equity-placement-agents-list">Full Agent Directory</a></li>
          <li><a href="/resources/placement-agents-guide">Free PDF Guide</a></li>
          <li><a href="/">Best Placement Agents 2025</a></li>
        </ul>
      </div>

      <div class="footer-section">
        <div class="footer-title">By Region</div>
        <ul class="footer-links">
          <li><a href="/top-private-equity-placement-agents-north-america">North America</a></li>
          <li><a href="/top-private-equity-placement-agents-europe">Europe</a></li>
          <li><a href="/top-private-equity-placement-agents-asia-pacific">Asia Pacific</a></li>
          <li><a href="/top-private-equity-placement-agents-uk">United Kingdom</a></li>
        </ul>
      </div>

      <div class="footer-section">
        <div class="footer-title">By Specialty</div>
        <ul class="footer-links">
          <li><a href="/venture-capital-placement-agents">VC Fundraising</a></li>
          <li><a href="/private-credit-placement-agents">Credit Funds</a></li>
          <li><a href="/real-estate-private-equity-placement-agents">RE Specialists</a></li>
          <li><a href="/boutique-private-equity-placement-agents">Boutique Agents</a></li>
        </ul>
      </div>

      <div class="footer-section">
        <div class="footer-title">Company</div>
        <ul class="footer-links">
          <li><a href="/about">About Us</a></li>
          <li><a href="/contact">Contact</a></li>
          <li><a href="/privacy">Privacy Policy</a></li>
          <li><a href="/terms">Terms & Conditions</a></li>
        </ul>
      </div>
    </div>

    <div class="footer-bottom">
      <p>© 2025 Placement. Your guide to the <a href="/" style="color: rgba(255, 255, 255, 0.6); text-decoration: underline;">best private equity placement agents</a> worldwide.</p>
    </div>
  </footer>

  <script define:vars={{ muxPlaybackId, heroCarouselItems }}>
    // Hero Carousel - rotate every 3 seconds
    let currentCarouselIndex = 0;
    const carouselInterval = 3000; // 3 seconds

    function rotateHeroCarousel() {
      const items = document.querySelectorAll('.hero-carousel-item');
      if (items.length <= 1) return;

      // Fade out current
      items[currentCarouselIndex].classList.remove('active');

      // Move to next
      currentCarouselIndex = (currentCarouselIndex + 1) % items.length;

      // Fade in next
      items[currentCarouselIndex].classList.add('active');

      // If next item is a video, try to load and play it
      const nextItem = items[currentCarouselIndex];
      if (nextItem.tagName === 'VIDEO' && !nextItem.src) {
        const videoIndex = parseInt(nextItem.getAttribute('data-carousel-index'));
        const videoSrc = `https://stream.mux.com/${heroCarouselItems[videoIndex].src}.m3u8`;

        // Lazy load hls.js for carousel videos
        if (nextItem.canPlayType('application/vnd.apple.mpegurl')) {
          // Native HLS support (Safari)
          nextItem.src = videoSrc;
          nextItem.play().catch(() => {});
        } else {
          // Load hls.js only when needed
          loadHLS(() => {
            if (typeof Hls !== 'undefined' && Hls.isSupported()) {
              const hls = new Hls({ maxBufferLength: 10 });
              hls.loadSource(videoSrc);
              hls.attachMedia(nextItem);
              hls.on(Hls.Events.MANIFEST_PARSED, () => nextItem.play().catch(() => {}));
            }
          });
        }
      }
    }

    // Performance: Check if mobile and connection speed
    const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
    const isSlowConnection = navigator.connection &&
      (navigator.connection.effectiveType === 'slow-2g' ||
       navigator.connection.effectiveType === '2g' ||
       navigator.connection.saveData);

    // Lazy load HLS.js only when needed and on good connections
    let hlsLoading = false;
    let hlsCallbacks = [];
    function loadHLS(callback) {
      if (typeof Hls !== 'undefined') {
        callback();
        return;
      }
      hlsCallbacks.push(callback);
      if (hlsLoading) return; // Already loading, callback will be called when ready
      hlsLoading = true;
      const script = document.createElement('script');
      script.src = 'https://cdn.jsdelivr.net/npm/hls.js@latest/dist/hls.light.min.js';
      script.async = true;
      script.onload = () => {
        hlsCallbacks.forEach(cb => cb());
        hlsCallbacks = [];
      };
      document.head.appendChild(script);
    }

    // Initialize video only when in viewport and on good connections
    function initVideo(videoId, sectionSelector) {
      // Skip video on slow connections
      if (isSlowConnection) {
        console.log('Skipping video on slow connection');
        return;
      }

      const section = document.querySelector(sectionSelector);
      if (!section) return;

      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            // Delay video loading slightly to prioritize other content
            setTimeout(() => {
              loadHLS(function() {
                const video = document.getElementById(videoId);
                const videoSrc = `https://stream.mux.com/${muxPlaybackId}.m3u8`;

                if (video && typeof Hls !== 'undefined' && Hls.isSupported()) {
                  const hls = new Hls({
                    maxBufferLength: 10, // Reduce buffer for faster start
                    maxMaxBufferLength: 20,
                  });
                  hls.loadSource(videoSrc);
                  hls.attachMedia(video);
                  hls.on(Hls.Events.MANIFEST_PARSED, function() {
                    video.play().catch(e => console.log('Video autoplay prevented:', e));
                  });
                } else if (video && video.canPlayType('application/vnd.apple.mpegurl')) {
                  video.src = videoSrc;
                  video.addEventListener('loadedmetadata', function() {
                    video.play().catch(e => console.log('Video autoplay prevented:', e));
                  });
                }
              });
            }, isMobile ? 500 : 0); // Delay on mobile
            observer.disconnect();
          }
        });
      }, { rootMargin: '100px' });
      observer.observe(section);
    }

    // Initialize news article videos with lazy loading
    function initNewsVideos() {
      const newsVideos = document.querySelectorAll('.news-video');
      if (!newsVideos.length) return;

      const videoObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            const video = entry.target;
            const playbackId = video.getAttribute('data-playback-id');
            if (!playbackId || video.src) return; // Already loaded

            const videoSrc = `https://stream.mux.com/${playbackId}.m3u8`;

            // Load HLS and play video
            loadHLS(function() {
              if (typeof Hls !== 'undefined' && Hls.isSupported()) {
                const hls = new Hls({ maxBufferLength: 5, maxMaxBufferLength: 10 });
                hls.loadSource(videoSrc);
                hls.attachMedia(video);
                hls.on(Hls.Events.MANIFEST_PARSED, function() {
                  video.play().then(() => {
                    video.style.opacity = '1'; // Fade in video
                  }).catch(() => {});
                });
              } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
                // Native HLS (Safari)
                video.src = videoSrc;
                video.addEventListener('loadedmetadata', function() {
                  video.play().then(() => {
                    video.style.opacity = '1';
                  }).catch(() => {});
                });
              }
            });

            videoObserver.unobserve(video);
          }
        });
      }, { rootMargin: '200px' }); // Start loading 200px before visible

      newsVideos.forEach(video => videoObserver.observe(video));
    }

    // Initialize videos when sections are near viewport
    window.addEventListener('DOMContentLoaded', function() {
      // Initialize first carousel item if it's a video
      initVideo('hero-carousel-0', '.hero');
      initVideo('companies-video', '.companies-section');

      // Initialize news article videos (lazy loaded)
      if (!isSlowConnection) {
        initNewsVideos();
      }

      // Start carousel rotation after page loads
      setInterval(rotateHeroCarousel, carouselInterval);

      // Load All functionality for top placement agencies
      const loadAllTopBtn = document.getElementById('load-all-top-agents');
      const loadTopButtons = document.getElementById('load-buttons-top');

      if (loadAllTopBtn) {
        loadAllTopBtn.addEventListener('click', function() {
          const section = loadTopButtons.closest('.companies-section');
          const hiddenCards = section.querySelectorAll('.company-card.hidden-card');
          hiddenCards.forEach(card => {
            card.classList.remove('hidden-card');
          });
          loadTopButtons.style.display = 'none';
        });
      }

      // Load All functionality for other placement agencies
      const loadAllOtherBtn = document.getElementById('load-all-other-agents');
      const loadOtherButtons = document.getElementById('load-buttons-other');

      if (loadAllOtherBtn) {
        loadAllOtherBtn.addEventListener('click', function() {
          const section = loadOtherButtons.closest('.companies-section');
          const hiddenCards = section.querySelectorAll('.company-card.hidden-card');
          hiddenCards.forEach(card => {
            card.classList.remove('hidden-card');
          });
          loadOtherButtons.style.display = 'none';
        });
      }
    });
  </script>
</body>
</html>
