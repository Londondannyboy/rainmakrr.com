---
import { siteConfig } from '../config/site';

interface Props {
  type?: 'homepage' | 'article' | 'company' | 'directory';
  article?: any;
  company?: any;
  companies?: any[];  // For directory pages ItemList
  pageTitle?: string;
  pageDescription?: string;
}

const { type = 'homepage', article, company, companies, pageTitle, pageDescription } = Astro.props;

const organizationSchema = {
  '@context': 'https://schema.org',
  '@type': 'Organization',
  name: siteConfig.name,
  url: siteConfig.url,
  logo: `${siteConfig.url}/logo.png`,
  description: 'The ultimate guide to top private equity placement agencies. Expert rankings, fee structures, capital raising insights, and market intelligence for PE fundraising success.',
  about: 'Comprehensive directory and guide to top private equity placement agencies, PE fundraising experts, and capital raising professionals worldwide. Connecting fund managers with leading placement agencies for successful institutional fundraising.',
  knowsAbout: [
    'Top Private Equity Placement Agencies',
    'Private Equity Fundraising',
    'Capital Raising',
    'Placement Agent Services',
    'LP Investor Networks',
    'PE Fund Marketing',
  ],
  sameAs: [
    siteConfig.links.twitter,
    siteConfig.links.linkedin,
  ],
};

const websiteSchema = {
  '@context': 'https://schema.org',
  '@type': 'WebSite',
  name: siteConfig.name,
  url: siteConfig.url,
  description: 'Comprehensive directory of top private equity placement agencies. Expert rankings, fee structures, capital raising insights, and market intelligence for PE fundraising success.',
  about: 'Top private equity placement agencies and PE fundraising resources',
  potentialAction: {
    '@type': 'SearchAction',
    target: {
      '@type': 'EntryPoint',
      urlTemplate: `${siteConfig.url}/search?q={search_term_string}`,
    },
    'query-input': 'required name=search_term_string',
  },
};

const breadcrumbSchema = {
  '@context': 'https://schema.org',
  '@type': 'BreadcrumbList',
  itemListElement: [
    {
      '@type': 'ListItem',
      position: 1,
      name: 'Home',
      item: siteConfig.url,
    },
  ],
};

let articleSchema;
if (type === 'article' && article) {
  articleSchema = {
    '@context': 'https://schema.org',
    '@type': 'Article',
    headline: article.title,
    description: article.excerpt || article.title,
    image: article.images?.hero || article.hero_image_legacy?.url,
    datePublished: article.published_at || article.created_at,
    dateModified: article.updated_at || article.published_at || article.created_at,
    author: {
      '@type': 'Organization',
      name: siteConfig.name,
    },
    publisher: {
      '@type': 'Organization',
      name: siteConfig.name,
      logo: {
        '@type': 'ImageObject',
        url: `${siteConfig.url}/logo.png`,
      },
    },
    mainEntityOfPage: {
      '@type': 'WebPage',
      '@id': `${siteConfig.url}/${article.slug}`,
    },
  };
}

let companySchema;
if (type === 'company' && company) {
  companySchema = {
    '@context': 'https://schema.org',
    '@type': 'Organization',
    name: company.name,
    description: company.description,
    url: company.website_url,
    logo: company.logo_url,
    address: {
      '@type': 'PostalAddress',
      addressLocality: company.headquarters,
    },
  };
}

// Citations Schema for Homepage - E-E-A-T signals
let citationSchema;
if (type === 'homepage') {
  citationSchema = {
    '@context': 'https://schema.org',
    '@type': 'AboutPage',
    name: 'Industry Rankings & Recognition',
    description: 'Rankings and data from leading industry sources including Preqin, Private Equity International, and proprietary research',
    citation: [
      {
        '@type': 'CreativeWork',
        name: 'Preqin 2025 Service Provider Report',
        url: 'https://www.preqin.com',
        publisher: {
          '@type': 'Organization',
          name: 'Preqin',
          description: 'Leading provider of private capital data and intelligence',
        },
      },
      {
        '@type': 'CreativeWork',
        name: 'Private Equity International Industry Analysis',
        url: 'https://www.privateequityinternational.com',
        publisher: {
          '@type': 'Organization',
          name: 'Private Equity International',
          description: 'Industry news, rankings, and market analysis',
        },
      },
      {
        '@type': 'CreativeWork',
        name: 'Preqin League Tables 2018-2025',
        url: 'https://www.gsequity.com/preqin',
        publisher: {
          '@type': 'Organization',
          name: 'Greenstone Equity Partners',
          description: 'Preqin global rankings data for placement agents',
        },
      },
    ],
  };
}

// ItemList Schema for directory pages - helps with rich snippets
let itemListSchema;
if (type === 'directory' && companies && companies.length > 0) {
  itemListSchema = {
    '@context': 'https://schema.org',
    '@type': 'ItemList',
    name: pageTitle || 'Private Equity Placement Agents Directory',
    description: pageDescription || 'Comprehensive list of top private equity placement agents',
    numberOfItems: companies.length,
    itemListElement: companies.slice(0, 20).map((company: any, index: number) => ({
      '@type': 'ListItem',
      position: index + 1,
      item: {
        '@type': 'Organization',
        name: company.display_name || company.name,
        description: company.description?.substring(0, 200) || `${company.display_name || company.name} - Private equity placement agent`,
        url: `${siteConfig.url}/private-equity-placement-agents-list/${company.slug}`,
        logo: company.logo_url,
        address: company.headquarters ? {
          '@type': 'PostalAddress',
          addressLocality: company.headquarters,
        } : undefined,
      },
    })),
  };
}

// CollectionPage schema for better indexing of directory pages
let collectionPageSchema;
if (type === 'directory') {
  collectionPageSchema = {
    '@context': 'https://schema.org',
    '@type': 'CollectionPage',
    name: pageTitle || 'Private Equity Placement Agents',
    description: pageDescription || 'Browse our directory of top private equity placement agents',
    url: Astro.url.href,
    isPartOf: {
      '@type': 'WebSite',
      name: siteConfig.name,
      url: siteConfig.url,
    },
    about: {
      '@type': 'Thing',
      name: 'Private Equity Placement Agents',
      description: 'Financial intermediaries specializing in capital raising for private equity funds',
    },
  };
}

let faqSchema;
if (type === 'homepage') {
  faqSchema = {
    '@context': 'https://schema.org',
    '@type': 'FAQPage',
    mainEntity: [
      {
        '@type': 'Question',
        name: 'What are top private equity placement agencies?',
        acceptedAnswer: {
          '@type': 'Answer',
          text: 'Top private equity placement agencies are specialized financial intermediaries who facilitate capital raising for private equity fund managers. These elite professionals serve as the critical bridge between General Partners (GPs) seeking to raise funds and institutional Limited Partners (LPs) with significant investment capacity. Leading placement agencies maintain extensive LP networks and provide sophisticated market intelligence.',
        },
      },
      {
        '@type': 'Question',
        name: 'Why should I work with top private equity placement agencies?',
        acceptedAnswer: {
          '@type': 'Answer',
          text: 'Engaging top private equity placement agencies provides fund managers with extensive LP networks, sophisticated market knowledge, compelling investment narratives, and access to institutional investors that would take years to develop independently. Leading placement agencies also offer guidance on fund structuring, terms negotiation, and competitive positioning within the PE fundraising landscape.',
        },
      },
      {
        '@type': 'Question',
        name: 'How do top private equity placement agencies get paid?',
        acceptedAnswer: {
          '@type': 'Answer',
          text: 'Top private equity placement agencies typically charge a combination of monthly retainers and success fees based on capital raised. Fees generally range from 1-2% of total capital raised for larger funds, with retainer models varying based on fund size, strategy, and agency reputation. Most agencies offer flexible engagement models including retainer-only, success-fee-only, or hybrid arrangements.',
        },
      },
      {
        '@type': 'Question',
        name: 'What services do top private equity placement agencies provide?',
        acceptedAnswer: {
          '@type': 'Answer',
          text: 'Top private equity placement agencies provide comprehensive fundraising services including LP network access, market intelligence, fund positioning strategy, pitch deck development, investor meetings coordination, terms negotiation support, and ongoing fundraising campaign management across the capital raising lifecycle. They also offer competitive landscape analysis and timing strategy guidance.',
        },
      },
    ],
  };
}
---

<script type="application/ld+json" set:html={JSON.stringify(organizationSchema)} />
<script type="application/ld+json" set:html={JSON.stringify(websiteSchema)} />
<script type="application/ld+json" set:html={JSON.stringify(breadcrumbSchema)} />
{articleSchema && <script type="application/ld+json" set:html={JSON.stringify(articleSchema)} />}
{companySchema && <script type="application/ld+json" set:html={JSON.stringify(companySchema)} />}
{faqSchema && <script type="application/ld+json" set:html={JSON.stringify(faqSchema)} />}
{citationSchema && <script type="application/ld+json" set:html={JSON.stringify(citationSchema)} />}
{itemListSchema && <script type="application/ld+json" set:html={JSON.stringify(itemListSchema)} />}
{collectionPageSchema && <script type="application/ld+json" set:html={JSON.stringify(collectionPageSchema)} />}
