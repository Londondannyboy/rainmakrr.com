---
/**
 * Comparison Component
 * Side-by-side comparison cards for options/choices
 *
 * @prop title - Section title
 * @prop items - Array of comparison items
 * @prop playbackId - Optional Mux playback ID for header image
 */
interface ComparisonItem {
  name: string;
  [key: string]: string;
}

interface Props {
  title?: string;
  items: ComparisonItem[];
  playbackId?: string;
}

const { title = "Compare Your Options", items, playbackId } = Astro.props;

function getMuxThumbnail(time: number): string {
  if (!playbackId) return '';
  return `https://image.mux.com/${playbackId}/thumbnail.jpg?time=${time}&width=800`;
}
---

{items.length > 0 && (
  <section class="mb-16">
    {playbackId && (
      <div class="relative rounded-xl mb-6 overflow-hidden">
        <img src={getMuxThumbnail(6)} alt="" class="w-full aspect-[21/9] object-cover" loading="lazy" />
        <div class="absolute inset-0 bg-gradient-to-t from-black/70 via-black/30 to-transparent"></div>
        <div class="absolute bottom-4 left-6">
          <h2 class="text-2xl md:text-3xl font-bold text-white drop-shadow-lg flex items-center gap-2">
            <span>ğŸ“Š</span> {title}
          </h2>
        </div>
      </div>
    )}

    <div class="grid md:grid-cols-2 gap-4">
      {items.map((item, i) => {
        const isFeatured = i === 1;
        const cardClass = isFeatured
          ? 'bg-gradient-to-br from-emerald-50 to-green-50 border-emerald-400'
          : 'bg-gradient-to-br from-gray-50 to-slate-50 border-gray-200';
        const titleColorClass = isFeatured ? 'text-emerald-800' : 'text-gray-900';
        const valueColorClass = isFeatured ? 'text-emerald-700' : 'text-gray-900';
        const icon = isFeatured ? 'ğŸ“ˆ' : 'ğŸ›ï¸';

        return (
          <div class={`rounded-xl p-5 border ${cardClass} hover:shadow-lg transition-shadow`}>
            <div class="flex items-start gap-4">
              <span class="text-4xl">{icon}</span>
              <div class="flex-1">
                <h3 class={`font-bold text-lg ${titleColorClass}`}>{item.name}</h3>
                <div class="mt-3 grid grid-cols-2 gap-3 text-sm">
                  {Object.entries(item)
                    .filter(([k]) => k !== 'name')
                    .map(([key, value]) => (
                      <div>
                        <span class="text-gray-500 text-xs uppercase tracking-wider">
                          {key.replace(/col\d/, 'Feature').replace(/_/g, ' ')}
                        </span>
                        <p class={`font-medium ${valueColorClass}`}>{value}</p>
                      </div>
                    ))}
                </div>
              </div>
            </div>
          </div>
        );
      })}
    </div>
  </section>
)}
